!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="++plone++senaite.app.listing.static/bundles",n(n.s=11)}([function(e,t){e.exports=React},function(e,t,n){"use strict";var r,o=n(0),i=n.n(o);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(){return(s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var o=d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return p(this,n)}}function p(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(a,e);var t,n,r,o=f(a);function a(){return c(this,a),o.apply(this,arguments)}return t=a,(n=[{key:"render",value:function(){return i.a.createElement("button",s({id:this.props.id,title:this.props.help||this.props.title,name:this.props.name,url:this.props.url,onClick:this.props.onClick,className:this.props.className},this.props.attrs),i.a.createElement("span",{dangerouslySetInnerHTML:{__html:this.props.title}}),this.props.badge&&i.a.createElement("span",{className:"badge badge-light",style:{marginLeft:"0.25em"}},this.props.badge))}}])&&l(t.prototype,n),r&&l(t,r),a}(i.a.Component),t.a=r},function(e,t,n){"use strict";var r,o=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function s(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},r=[],o=0;o<e.length;o++){var i=e[o],c=t.base?i[0]+t.base:i[0],l=n[c]||0,u="".concat(c," ").concat(l);n[c]=l+1;var f=s(u),p={css:i[1],media:i[2],sourceMap:i[3]};-1!==f?(a[f].references++,a[f].updater(p)):a.push({identifier:u,updater:m(p,t),references:1}),r.push(u)}return r}function l(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var u,f=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function p(e,t,n,r){var o=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=f(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function d(e,t,n){var r=n.css,o=n.media,i=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),i&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var h=null,_=0;function m(e,t){var n,r,o;if(t.singleton){var i=_++;n=h||(h=l(t)),r=p.bind(null,n,i,!1),o=p.bind(null,n,i,!0)}else n=l(t),r=d.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=o());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var o=s(n[r]);a[o].references--}for(var i=c(e,t),l=0;l<n.length;l++){var u=s(n[l]);0===a[u].references&&(a[u].updater(),a.splice(u,1))}n=i}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(a=r,s=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(s),"/*# ".concat(c," */")),i=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(i).concat([o]).join("\n")}var a,s,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(r)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var s=0;s<e.length;s++){var c=[].concat(e[s]);r&&o[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";(function(e){var r=n(0),o=n.n(r),i=n(1);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=p(e);if(t){var o=p(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?f(e):t}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var d,h=[].indexOf;d=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(p,t);var n,r,a,u=l(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=u.call(this,e)).on_ajax_save_button_click=t.on_ajax_save_button_click.bind(f(t)),t.on_transition_button_click=t.on_transition_button_click.bind(f(t)),t.confirm_transitions=["cancel","deactivate","invalidate","reject","remove","retract","unassign","retest"],t.css_mapping={reassign:"btn-secondary",duplicate:"btn-secondary",close:"btn-secondary",assign:"btn-secondary",receive:"btn-primary",open:"btn-primary",verify:"btn-primary",retest:"btn-primary",activate:"btn-success",prepublish:"btn-success",publish:"btn-success",republish:"btn-success",submit:"btn-success",unassign:"btn-warning",cancel:"btn-danger",deactivate:"btn-danger",invalidate:"btn-danger",reject:"btn-danger",retract:"btn-danger",remove:"btn-danger"},t}return n=p,(r=[{key:"componentDidUpdate",value:function(){return e("[data-toggle=confirmation]").confirmation({rootSelector:"[data-toggle=confirmation]",btnOkLabel:_t("Yes"),btnOkClass:"btn btn-outline-primary",btnOkIconClass:"fas fa-check-circle mr-1",btnCancelLabel:_t("No"),btnCancelClass:"btn btn-outline-secondary",btnCancelIconClass:"fas fa-circle mr-1",container:"body",singleton:!0})}},{key:"get_button_css",value:function(e){var t,n;return n="btn btn-sm mr-1 mb-1",n+=(t=this.css_mapping[e])?" ".concat(t):" btn-outline-secondary"}},{key:"on_ajax_save_button_click",value:function(e){if(e.preventDefault(),this.props.on_ajax_save_button_click)return this.props.on_ajax_save_button_click()}},{key:"on_transition_button_click",value:function(e){var t,n,r;if(e.preventDefault(),t=(n=e.currentTarget).getAttribute("id"),r=n.getAttribute("url"),this.props.on_transition_button_click)return this.props.on_transition_button_click(t,r)}},{key:"build_buttons",value:function(){var e,t,n,r,a,s,c,l,u,f,p,d,_;for(n=[],this.props.show_select_column&&this.props.transitions.length>0&&n.push(o.a.createElement("button",{key:"clear",className:"btn btn-outline-secondary btn-sm mb-1 mr-1",title:_t("Clear selection"),onClick:this.on_transition_button_click,id:"clear_selection"},o.a.createElement("i",{className:"fas fa-circle-notch"}))),this.props.show_ajax_save&&n.push(o.a.createElement("button",{key:"ajax-save",className:"btn btn-primary btn-sm mb-1 mr-1",onClick:this.on_ajax_save_button_click,title:this.props.ajax_save_button_title,id:"ajax_save_selection"},this.props.ajax_save_button_title," ",o.a.createElement("i",{className:"fas fa-save"}))),s=0,l=(u=this.props.transitions).length;s<l;s++)c=(d=u[s]).id,_=d.url,p=_t(d.title),a=_t(d.help),r=this.get_button_css(c),t="".concat(c,"_transition"),d.css_class&&(r+=" ".concat(d.css_class)),f=this.props.review_state.confirm_transitions||[],e={},(h.call(this.confirm_transitions,c)>=0||h.call(f,c)>=0)&&(e["data-toggle"]="confirmation",e["data-title"]="".concat(p,"?")),n.push(o.a.createElement(i.a,{key:d.id,id:t,title:p,help:a,url:_,className:r,badge:this.props.selected_uids.length,onClick:this.on_transition_button_click,attrs:e}));return n}},{key:"render",value:function(){return 0===this.props.selected_uids.length?null:o.a.createElement("div",{className:"".concat(this.props.className)},this.build_buttons())}}])&&s(n.prototype,r),a&&s(n,a),p}(o.a.Component),t.a=d}).call(this,n(6))},function(e,t){e.exports=jQuery},function(e,t,n){var r=n(2),o=n(8);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};r(o,i);e.exports=o.locals||{}},function(e,t,n){(t=n(3)(!1)).push([e.i,".loader {\n  position: relative;\n  width: 44px;\n  height: 8px;\n  margin: 12px auto;\n}\n\n.dot {\n  display: inline-block;\n  width: 8px;\n  height: 8px;\n  border-radius: 4px;\n  background: #ccc;\n  position: absolute;\n}\n\n.dot_1 {\n  animation: animateDot1 1.5s linear infinite;\n  left: 12px;\n  background: #e579b8;\n}\n\n.dot_2 {\n  animation: animateDot2 1.5s linear infinite;\n  animation-delay: 0.5s;\n  left: 24px;\n}\n\n.dot_3 {\n  animation: animateDot3 1.5s linear infinite;\n  left: 12px;\n}\n\n.dot_4 {\n  animation: animateDot4 1.5s linear infinite;\n  animation-delay: 0.5s;\n  left: 24px;\n}\n\n@keyframes animateDot1 {\n  0% {\n    transform: rotate(0deg) translateX(-12px);\n  }\n  25% {\n    transform: rotate(180deg) translateX(-12px);\n  }\n  75% {\n    transform: rotate(180deg) translateX(-12px);\n  }\n  100% {\n    transform: rotate(360deg) translateX(-12px);\n  }\n}\n@keyframes animateDot2 {\n  0% {\n    transform: rotate(0deg) translateX(-12px);\n  }\n  25% {\n    transform: rotate(-180deg) translateX(-12px);\n  }\n  75% {\n    transform: rotate(-180deg) translateX(-12px);\n  }\n  100% {\n    transform: rotate(-360deg) translateX(-12px);\n  }\n}\n@keyframes animateDot3 {\n  0% {\n    transform: rotate(0deg) translateX(12px);\n  }\n  25% {\n    transform: rotate(180deg) translateX(12px);\n  }\n  75% {\n    transform: rotate(180deg) translateX(12px);\n  }\n  100% {\n    transform: rotate(360deg) translateX(12px);\n  }\n}\n@keyframes animateDot4 {\n  0% {\n    transform: rotate(0deg) translateX(12px);\n  }\n  25% {\n    transform: rotate(-180deg) translateX(12px);\n  }\n  75% {\n    transform: rotate(-180deg) translateX(12px);\n  }\n  100% {\n    transform: rotate(-360deg) translateX(12px);\n  }\n}\n",""]),e.exports=t},function(e,t,n){var r=n(2),o=n(10);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};r(o,i);e.exports=o.locals||{}},function(e,t,n){(t=n(3)(!1)).push([e.i,'/* Listing Styles */\n\n/* Colors taken from https://mdbootstrap.com/css/colors/ */\n.ajax-contents-table tbody tr { border-left:2px solid #ddd; }\n.ajax-contents-table tbody tr:last-child { border-bottom:1px solid #ddd; }\n\n/* state sample_due */\n.ajax-contents-table tr.state-sample_due { border-left:2px solid #ffff8d !important; }\n.ajax-contents-table td.result.state-sample_due { border-left:2px solid #ffff8d !important; }\n.ajax-contents-table tr.state-sample_due:hover { background-color: rgba(255, 235, 59, 0.1); }\n\n/* state sample_received */\n.ajax-contents-table tr.state-sample_received { border-left:2px solid #a1887f !important; }\n.ajax-contents-table td.result.state-sample_received { border-left:2px solid #a1887f !important; }\n.ajax-contents-table tr.state-sample_received:hover { background-color: rgba(121, 85, 72, 0.1); }\n\n/* state retracted */\n.ajax-contents-table tr.state-retracted { border-left:2px solid #ff6f00 !important; }\n.ajax-contents-table tr.state-retracted>td:not([rowspan]) { background-color: #eceff1 !important; color: #78909c; font-style: italic; }\n.ajax-contents-table td.result.state-retracted { border-left:2px solid #ff6f00 !important; }\n.ajax-contents-table tr.state-retracted:hover { background-color: rgba(255, 152, 0, 0.1); }\n\n/* state to_be_verified */\n.ajax-contents-table tr.state-to_be_verified { border-left:2px solid #18ffff !important; }\n.ajax-contents-table td.result.state-to_be_verified { border-left:2px solid #18ffff !important; }\n.ajax-contents-table tr.state-to_be_verified:hover { background-color: rgba(0, 188, 212, 0.1); }\n\n/* state verified */\n.ajax-contents-table tr.state-verified { border-left:2px solid #0091ea !important; }\n.ajax-contents-table td.result.state-verified { border-left:2px solid #0091ea !important; }\n.ajax-contents-table tr.state-verified:hover { background-color: rgba(3, 169, 244, 0.2); }\n\n/* state published */\n.ajax-contents-table tr.state-published { border-left:2px solid #00c853 !important; }\n.ajax-contents-table td.result.state-published { border-left:2px solid #00c853 !important; }\n.ajax-contents-table tr.state-published:hover { background-color: rgba(76, 175, 80, 0.2); }\n\n/* state invalid */\n.ajax-contents-table tr.state-invalid { border-left:2px solid #e65100 !important; }\n.ajax-contents-table td.result.state-invalid { border-left:2px solid #e65100 !important; }\n.ajax-contents-table tr.state-invalid:hover { background-color: rgba(244, 67, 54, 0.2); }\n\n/* state rejected */\n.ajax-contents-table tr.state-rejected { border-left:2px solid #abc !important; }\n.ajax-contents-table td.result.state-rejected { border-left:2px solid #abc !important; }\n.ajax-contents-table tr.state-rejected:hover { background-color: #abc; }\n\n/* state assigned */\n.ajax-contents-table tr.state-assigned { border-left:2px solid #ddd; }\n.ajax-contents-table td.result.state-assigned { border-left:2px solid transparent; }\n\n/* state unassigned */\n.ajax-contents-table tr.state-unassigned { border-left:2px solid #ddd; }\n.ajax-contents-table td.result.state-unassigned { border-left:2px solid transparent; }\n\n/* state attachment-due */\n.ajax-contents-table tr.state-attachment_due { border-left:2px solid #ffc107 !important; }\n.ajax-contents-table td.result.state-attachment_due { border-left:2px solid #ffc107 !important; }\n.ajax-contents-table tr.state-attachment_due:hover { background-color: rgba(255, 152, 0, 0.2); }\n\n/* state cancelled */\n.ajax-contents-table tr.state-cancelled { border-left:2px solid #000000 !important; }\n.ajax-contents-table tr.state-cancelled:hover { background-color: rgba(0, 0, 0, 0.1); }\n\n/* worksheet states */\n.ajax-contents-table tr.state-open { border-left:2px solid #ddd  !important; }\n.ajax-contents-table tr.state-empty-worksheet { border-left:2px solid #ddd !important; }\n\n/* transposed worksheet layout*/\n.ajax-contents-table td.transposed.result.empty { cursor: not-allowed; }\n.ajax-contents-table td.transposed.result:hover { background-color: #e3e3e3!important; }\n.ajax-contents-table td.transposed.result.empty:hover { background-color: #e3e3e3; }\n\n/* active/inactive states*/\n.ajax-contents-table tr.state-active { border-left:2px solid transparent; }\n.ajax-contents-table tr.state-inactive { border-left:2px solid #616161; }\n\n.ajax-contents-table th.sortable { cursor: pointer; }\n.ajax-contents-table th.sortable:hover { background-color: #ccc; }\n.ajax-contents-table th:not(.sortable) { cursor: not-allowed; }\n\n.ajax-contents-table th.active.ascending span:after { content: "▲"; margin-left: 0.5em; }\n.ajax-contents-table th.active.descending span:after { content: "▼"; margin-left: 0.5em; }\n\n/* category */\n.ajax-contents-table tr.categoryrow { border-left: none; background-color: rgba(96, 125, 139, 0.1)!important; cursor: pointer; font-weight: bold; font-size: 115%; color: #3E4551; }\n\n/* table load mask */\n#table-overlay {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 1000;\n  height: 100%;\n  width: 100%;\n  background: rgba(96, 125, 139, 0.3);\n  opacity: 0.3;\n}\n\n/* progress bar */\n.ajax-contents-table tr td div.progress { width: 55px; margin-bottom: 0; height: 17px; }\n.ajax-contents-table tr td div.progress div.progress-bar { color: #f5f5f5; background-color: #33b5e5; line-height: 17px; font-size: 9px; font-weight:bold; }\n.ajax-contents-table tr.state-invalid td div.progress div.progress-bar,\n.ajax-contents-table tr.state-cancelled td div.progress div.progress-bar { background-color: #c9c9c9; }\n\n/* collapsible rows */\n.ajax-contents-table tr.togglerow { cursor: pointer; }\n.ajax-contents-table tr.childrow td:first-child { padding-left: 1em; }\n.ajax-contents-table tr.childrow td:first-child:before { content: "➥ "; }\n\n/* before item */\n.ajax-contents-table tr span.before-item { display: table-cell; line-height: 0; vertical-align: middle; padding-right: 5px; }\n\n/* after item */\n.ajax-contents-table tr span.after-item { display: table-cell; line-height: 0; vertical-align: middle;  padding-left: 5px; }\n\n/* Render table form-controls smaller */\n.ajax-contents-table tr td div.form-group { display: inline-table; }\n\n/* Top toolbar */\n.ajax-contents-table .top-toolbar { padding-bottom: .5em; }\n\n/* Expandable Rows */\n.ajax-contents-table tr.contentrow.child td {\n    border-top:none;\n}\n.ajax-contents-table tr.contentrow.collapsed td:first-child:before,\n.ajax-contents-table tr.contentrow.expanded td:first-child:before,\n.ajax-contents-table tr.contentrow.child td:first-child:before {\n    padding-right: 0.5rem;\n    vertical-align: bottom;\n    color: #555;\n    cursor: pointer;\n    float: left;\n}\n.ajax-contents-table tr.contentrow.collapsed td:first-child:before {\n    content: "▶";\n}\n.ajax-contents-table tr.contentrow.expanded td:first-child:before {\n    content: "▼";\n}\n.ajax-contents-table tr.contentrow.child td:first-child:before {\n    content: "⋯";\n}\n\n/* Remark Rows */\n.ajax-contents-table tr.remarksrow td {\n    padding: 0;\n    border: none;\n}\n.ajax-contents-table tr.remarksrow td div.remarks {\n    min-height: 20px;\n    padding: 5px;\n    margin: 5px;\n    background-color: #f5f5f5;\n    border: 1px solid #e3e3e3;\n    border-radius: 3px;\n}\n\n/* Multi choice */\n.ajax-contents-table tr td div.multichoice {\n    max-height: 120px;\n    width: 200px;\n    overflow: auto;\n    border: 1px solid #ccc;\n    border-radius: 3px;\n}\n.ajax-contents-table tr td div.multichoice ul {\n    padding: 0;\n    margin: 0;\n}\n.ajax-contents-table tr td div.multichoice li {\n    padding: 6px;\n}\n.ajax-contents-table tr td div.multichoice li:hover {\n    background-color: #f9f9f9;\n}\n\n/* Result multi choice */\n.ajax-contents-table tr td.Result div.multichoice {\n    border: none;\n}\n.ajax-contents-table tr td.Result div.multichoice li {\n    padding: 4px 6px;\n}\n\n/* Multi select */\n.ajax-contents-table tr td div.multiselect ul {\n    padding: 0;\n    margin: 0;\n}\n.ajax-contents-table tr td div.multiselect li {\n    padding: 2px 6px;\n}\n\n/* Rowspan support */\n.ajax-contents-table tr td[rowspan] {\n    border: 1px solid #ddd;\n    background-color: white!important;\n}\n.ajax-contents-table tr td[rowspan]:hover {\n    background-color: white!important;\n}\n\n/* borderless table */\n.ajax-contents-table table.table-borderless td { border: none!important; }\n.ajax-contents-table table.table-borderless tr { border: none!important; }\n\n/* Worksheet\'s slots table */\n.ajax-contents-table table.slot-header-table { margin-bottom: 0px; }\n\n/* Results Unit */\n.ajax-contents-table span.unit { padding: 0 0.25em; color: black; }\n\n\n/* Transposed Cell */\n.ajax-contents-table td.transposed span.before-item { width: 60px }\n.ajax-contents-table td.transposed span.before-item > * { display: block; float: left; padding-right: 5px; }\n.ajax-contents-table td.transposed span.before-item input[type=checkbox] { margin: 0; }\n.ajax-contents-table td.transposed input { margin-right: 10px; }\n.ajax-contents-table td.transposed .before_field { font-size: 85%; display: table-cell; }\n.ajax-contents-table td.transposed .after_field { font-size: 85%; display: table-cell; }\n.ajax-contents-table td.transposed span.readonly { padding-right: 0.5em; }\n\n/* Regular Cell */\n.ajax-contents-table td a.remarks { display: block; }\n',""]),e.exports=t},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=n(4),a=n.n(i),s=n(5),c=n(1);function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=m(e);if(t){var o=m(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return d(this,n)}}function d(e,t){return!t||"object"!==l(t)&&"function"!=typeof t?h(e):t}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(a,e);var t,n,r,i=p(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_filter_button_clicked=t.on_filter_button_clicked.bind(h(t)),t}return t=a,(n=[{key:"on_filter_button_clicked",value:function(e){var t;return e.preventDefault(),t=e.currentTarget.id,this.props.on_filter_button_clicked(t)}},{key:"build_filter_buttons",value:function(){var e,t,n,r,i,a;for(r in t=[],e=this.props.review_state,i=this.props.review_states)n="nav-item btn btn-sm btn-outline-secondary mr-1 mb-1",(a=i[r]).id===e&&(n+=" active"),t.push(o.a.createElement(c.a,{key:a.id,onClick:this.on_filter_button_clicked,id:a.id,title:a.title,className:n}));return 1===t.length?[]:t}},{key:"render",value:function(){return o.a.createElement("div",{className:this.props.className},this.build_filter_buttons())}}])&&u(t.prototype,n),r&&u(t,r),a}(o.a.Component);function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),console.debug("ListingAPI::constructor"),this.api_url=t.api_url,this.on_api_error=t.on_api_error||function(e){},this}var t,n,r;return t=e,(n=[{key:"get_api_url",value:function(e){return"".concat(this.api_url,"/").concat(e).concat(location.search)}},{key:"get_url_parameter",value:function(e){var t;return e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null===(t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search))?"":decodeURIComponent(t[1].replace(/\+/g," "))}},{key:"get_json",value:function(e,t){var n,r,o,i,a,s;return null==t&&(t={}),o=t.method||"POST",n=JSON.stringify(t.data)||"{}",i=this.on_api_error,s=this.get_api_url(e),r={method:o,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":this.get_csrf_token()},body:"POST"===o?n:null,credentials:"include"},console.info("ListingAPI::fetch:endpoint=".concat(e," init="),r),a=new Request(s,r),fetch(a).then((function(e){return e.ok?e:Promise.reject(e)})).then((function(e){return e.json()})).catch((function(e){return i(e),e}))}},{key:"set_fields",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("set_fields",t)}},{key:"query_folderitems",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("query_folderitems",t)}},{key:"fetch_children",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("get_children",t)}},{key:"fetch_folderitems",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("folderitems",t)}},{key:"fetch_transitions",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("transitions",t)}},{key:"get_csrf_token",value:function(){return document.querySelector("#protect-script").dataset.token}}])&&b(t.prototype,n),r&&b(t,r),e}();n(7);function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=S(e);if(t){var o=S(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return j(this,n)}}function j(e,t){return!t||"object"!==v(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(a,e);var t,n,r,i=O(a);function a(){return k(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"render",value:function(){return this.props.loading?o.a.createElement("div",{className:"loader"},o.a.createElement("span",{className:"dot dot_1"}),o.a.createElement("span",{className:"dot dot_2"}),o.a.createElement("span",{className:"dot dot_3"}),o.a.createElement("span",{className:"dot dot_4"})):o.a.createElement("div",{className:"loader"})}}])&&w(t.prototype,n),r&&w(t,r),a}(o.a.Component);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=I(e);if(t){var o=I(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return T(this,n)}}function T(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?D(e):t}function D(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var L=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(a,e);var t,n,r,i=C(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_dismiss_message=t.on_dismiss_message.bind(D(t)),t}return t=a,(n=[{key:"on_dismiss_message",value:function(e){var t;if(e.preventDefault(),t=e.currentTarget.getAttribute("index"),this.props.on_dismiss_message)return this.props.on_dismiss_message(parseInt(t))}},{key:"render_messages",value:function(){var e,t;return t=[],e=this,this.props.messages.map((function(n,r){return t.push(o.a.createElement("div",{key:r,className:"alert alert-".concat(n.level||"info")},o.a.createElement("button",{onClick:e.on_dismiss_message,index:r,type:"button",className:"close","aria-label":"Close"},o.a.createElement("span",{"aria-hidden":"true"},"×")),n.title&&o.a.createElement("h4",{className:"alert-heading"},n.title),n.text&&o.a.createElement("div",null,n.text),n.traceback&&o.a.createElement("pre",null,n.traceback)))})),t}},{key:"render",value:function(){return this.props.messages?o.a.createElement("div",{id:this.props.id,className:this.props.className},this.render_messages()):null}}])&&P(t.prototype,n),r&&P(t,r),a}(o.a.Component);function A(e){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function M(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=B(e);if(t){var o=B(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return H(this,n)}}function H(e,t){return!t||"object"!==A(t)&&"function"!=typeof t?V(e):t}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var U=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(a,e);var t,n,r,i=z(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={pagesize:t.props.pagesize},t.on_show_more_click=t.on_show_more_click.bind(V(t)),t.on_pagesize_change=t.on_pagesize_change.bind(V(t)),t.pagesize_input=o.a.createRef(),t.show_more_button=o.a.createRef(),t}return t=a,(n=[{key:"on_show_more_click",value:function(e){var t;return e.preventDefault(),(!(t=parseInt(this.pagesize_input.current.value))||t<1)&&(t=1),this.props.onShowMore(t)}},{key:"on_pagesize_change",value:function(e){var t;if(t=this.get_pagesize_input_value(),this.setState({pagesize:t}),13===e.which)return e.preventDefault(),this.props.onShowMore(t)}},{key:"get_pagesize_input_value",value:function(){var e;return(!(e=parseInt(this.pagesize_input.current.value))||e<1)&&(e=1,this.pagesize_input.current.value=e),e}},{key:"render",value:function(){return this.props.count>=this.props.total?o.a.createElement("div",{className:"text-right"},this.props.count," / ",this.props.total):o.a.createElement("div",{id:this.props.id,className:this.props.className},o.a.createElement("div",{className:"input-group input-group-sm text-right"},o.a.createElement("div",{className:"input-group-prepend"},o.a.createElement("span",{className:"input-group-text"},this.props.count," / ",this.props.total)),o.a.createElement("input",{type:"text",defaultValue:this.state.pagesize,onChange:this.on_pagesize_change,onKeyPress:this.on_pagesize_change,ref:this.pagesize_input,disabled:this.props.count>=this.props.total,className:"form-control"}),o.a.createElement("span",{className:"input-group-append"},o.a.createElement("button",{className:"btn btn-outline-secondary",disabled:this.props.count>=this.props.total,ref:this.show_more_button,onClick:this.on_show_more_click},o.a.createElement("span",null,this.props.show_more_button_title||"Show more")))))}}])&&M(t.prototype,n),r&&M(t,r),a}(o.a.Component);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function X(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=K(e);if(t){var o=K(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return G(this,n)}}function G(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?Q(e):t}function Q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var $=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(a,e);var t,n,r,i=Z(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_search_field_keypress=t.on_search_field_keypress.bind(Q(t)),t.on_search_button_click=t.on_search_button_click.bind(Q(t)),t.on_clear_button_click=t.on_clear_button_click.bind(Q(t)),t.search_input_field=o.a.createRef(),t}return t=a,(n=[{key:"on_search_field_keypress",value:function(e){var t;if(13===e.which)return e.preventDefault(),t=this.get_search_value(),this.props.on_search(t)}},{key:"on_search_button_click",value:function(e){var t;return e.preventDefault(),t=this.get_search_value(),this.props.on_search(t)}},{key:"on_clear_button_click",value:function(e){return e.preventDefault(),this.search_input_field.current.value="",this.props.on_search("")}},{key:"get_search_value",value:function(){return this.search_input_field.current.value}},{key:"render",value:function(){return!1===this.props.show_search?null:o.a.createElement("div",{className:"input-group input-group-sm"},o.a.createElement("input",{type:"text",autofocus:"true",className:"form-control",ref:this.search_input_field,defaultValue:this.props.filter,onKeyPress:this.on_search_field_keypress,placeholder:this.props.placeholder}),o.a.createElement("span",{className:"input-group-append"},o.a.createElement("button",{className:"btn btn-outline-secondary",onClick:this.on_clear_button_click},o.a.createElement("i",{className:"fas fa-undo"})),o.a.createElement("button",{className:"btn btn-outline-secondary",onClick:this.on_search_button_click},o.a.createElement("i",{className:"fas fa-search"}))))}}])&&X(t.prototype,n),r&&X(t,r),a}(o.a.Component);function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(){return(Y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e,t){return(te=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ie(e);if(t){var o=ie(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return re(this,n)}}function re(e,t){return!t||"object"!==W(t)&&"function"!=typeof t?oe(e):t}function oe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ie(e){return(ie=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ae=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&te(e,t)}(a,e);var t,n,r,i=ne(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_change=t.on_change.bind(oe(t)),t}return t=a,(n=[{key:"on_change",value:function(e){var t,n,r,o;if(o=(n=e.currentTarget).getAttribute("uid"),r=n.getAttribute("column_key")||n.name,t=n.checked,console.debug("Checkbox::on_change: checked=".concat(t)),this.props.update_editable_field&&this.props.update_editable_field(o,r,t,this.props.item),this.props.save_editable_field)return this.props.save_editable_field(o,r,t,this.props.item)}},{key:"render",value:function(){return o.a.createElement("span",{className:"form-group"},this.props.before&&o.a.createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),o.a.createElement("input",Y({key:this.props.name,type:"checkbox",uid:this.props.uid,name:this.props.name,value:this.props.value,column_key:this.props.column_key,title:this.props.title,disabled:this.props.disabled,checked:this.props.checked,defaultChecked:this.props.defaultChecked,className:this.props.className,onChange:this.props.onChange||this.on_change},this.props.attrs)),this.props.after&&o.a.createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&ee(t.prototype,n),r&&ee(t,r),a}(o.a.Component);function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe(e);if(t){var o=pe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fe(this,n)}}function fe(e,t){return!t||"object"!==se(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var de=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(a,e);var t,n,r,i=ue(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"render",value:function(){return o.a.createElement("th",{title:this.props.title,index:this.props.index,sort_order:this.props.sort_order,className:this.props.className,onClick:this.props.onClick},o.a.createElement("span",null,this.props.title))}}])&&ce(t.prototype,n),r&&ce(t,r),a}(o.a.Component);function he(e){return(he="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _e(){return(_e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ye(e,t){return(ye=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ke(e);if(t){var o=ke(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ge(this,n)}}function ge(e,t){return!t||"object"!==he(t)&&"function"!=typeof t?ve(e):t}function ve(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ke(e){return(ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var we=[].indexOf,xe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ye(e,t)}(a,e);var t,n,r,i=be(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_header_column_click=t.on_header_column_click.bind(ve(t)),t}return t=a,(n=[{key:"on_header_column_click",value:function(e){var t,n,r;if(n=(t=e.currentTarget).getAttribute("index"),r=t.getAttribute("sort_order"),n)return console.debug("HEADER CLICKED sort_on='".concat(n,"' sort_order=").concat(r)),we.call(t.classList,"active")>=0&&(r="ascending"===r?"descending":"ascending"),this.props.on_header_column_click(n,r)}},{key:"is_required_column",value:function(e){var t,n;return 0!==(t=this.props.folderitems||[]).length&&(n=t[0].required||[],we.call(n,e)>=0)}},{key:"is_sortable",value:function(e,t){return!1!==e.sortable&&(!!e.index||we.call(this.props.sortable_columns,t)>=0)}},{key:"all_selected",value:function(){var e,t,n,r,o;for(e=0,n=(r=this.props.folderitems).length;e<n;e++)if(!(t=r[e]).disabled&&(o=t.uid,we.call(this.props.selected_uids,o)<0))return!1;return!0}},{key:"build_cells",value:function(){var e,t,n,r,i,a,s,c,l,u,f,p,d,h,_,m;for(t=[],this.props.item,this.props.show_select_column&&(e=this.all_selected(),p=this.props.show_select_all_checkbox,t.push(o.a.createElement("th",{key:"select_all"},p&&o.a.createElement(ae,{name:"select_all",value:"all",checked:e,onChange:this.props.on_select_checkbox_checked})))),i=0,l=(u=this.props.visible_columns).length;i<l;i++)c=u[i],r=this.props.columns[c],_=this.is_sortable(r,c),a=r.index||c,m=r.title,d=this.props.sort_on||"created",h=this.props.sort_order||"ascending",s=a===d,f=this.is_required_column(c),n=[c],_&&n.push("sortable"),s&&_&&n.push("active ".concat(h)),f&&n.push("required"),n=n.join(" "),t.push(o.a.createElement(de,_e({key:c},this.props,{title:m,index:a,sort_order:h,className:n,onClick:_?this.on_header_column_click:void 0})));return t}},{key:"render",value:function(){return o.a.createElement("tr",{onContextMenu:this.props.on_context_menu},this.build_cells())}}])&&me(t.prototype,n),r&&me(t,r),a}(o.a.Component);function Oe(e){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function je(){return(je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Se(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Re(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ne(e);if(t){var o=Ne(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pe(this,n)}}function Pe(e,t){return!t||"object"!==Oe(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ne(e){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(a,e);var t,n,r,i=Re(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"render",value:function(){return o.a.createElement("span",{className:"form-group"},this.props.before&&o.a.createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),o.a.createElement("input",je({type:"hidden",uid:this.props.uid,name:this.props.name,value:this.props.value,column_key:this.props.column_key,className:this.props.className},this.props.attrs)),this.props.after&&o.a.createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&Se(t.prototype,n),r&&Se(t,r),a}(o.a.Component);function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function De(){return(De=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ie(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Le(e,t){return(Le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ae(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ze(e);if(t){var o=ze(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Me(this,n)}}function Me(e,t){return!t||"object"!==Te(t)&&"function"!=typeof t?qe(e):t}function qe(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ze(e){return(ze=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var He=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Le(e,t)}(a,e);var t,n,r,i=Ae(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_change=t.on_change.bind(qe(t)),t}return t=a,(n=[{key:"on_change",value:function(e){var t,n,r,o,i,a;if(i=e.currentTarget.parentNode.parentNode,t=i.querySelectorAll("input[type='checkbox']:checked"),o=i.getAttribute("uid"),r=i.getAttribute("column_key")||i.name,a=function(){var e,r,o;for(o=[],e=0,r=t.length;e<r;e++)n=t[e],o.push(n.value);return o}(),console.debug("MultiChoice::on_change: value=".concat(a)),this.props.update_editable_field)return this.props.update_editable_field(o,r,a,this.props.item)}},{key:"build_options",value:function(){var e,t,n,r,i,a,s,c;for(r=[],e=0,t=(a=this.props.options.sort((function(e,t){var n,r;return(n=e.ResultText)>(r=t.ResultText)?1:n<r?-1:0}))).length;e<t;e++)c=(n=a[e]).ResultValue,s=n.ResultText,i=n.selected||!1,r.push(o.a.createElement("li",{key:c},o.a.createElement("input",De({type:"checkbox",defaultChecked:i,value:c,onChange:this.props.onChange||this.on_change},this.props.attrs))," ",s));return r}},{key:"render",value:function(){return o.a.createElement("div",{className:"multichoice"},this.props.before&&o.a.createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),o.a.createElement("ul",{className:"list-unstyled",uid:this.props.uid,column_key:this.props.column_key,name:this.props.name,tabIndex:this.props.tabIndex},this.build_options()),this.props.after&&o.a.createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&Ie(t.prototype,n),r&&Ie(t,r),a}(o.a.Component);function Ve(e){return(Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(){return(Be=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fe(e,t){return(Fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xe(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ge(e);if(t){var o=Ge(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Je(this,n)}}function Je(e,t){return!t||"object"!==Ve(t)&&"function"!=typeof t?Ze(e):t}function Ze(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ge(e){return(Ge=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qe=[].indexOf,Ke=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fe(e,t)}(a,e);var t,n,r,i=Xe(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={value:e.defaultValue},t.on_change=t.on_change.bind(Ze(t)),t}return t=a,(n=[{key:"on_change",value:function(e){var t,n,r,o,i,a;if(i=e.currentTarget.parentNode.parentNode,t=i.querySelectorAll("select"),o=i.getAttribute("uid"),r=i.getAttribute("column_key")||i.name,a=function(){var e,r,o;for(o=[],e=0,r=t.length;e<r;e++)n=t[e],o.push(n.value);return o}(),this.setState({value:a}),console.debug("MultiSelect::on_change: name=".concat(r," value=").concat(a)),this.props.update_editable_field)return this.props.update_editable_field(o,r,a,this.props.item)}},{key:"build_options",value:function(e){var t,n,r,i,a,s,c,l;for(i=[],0===(a=(a=this.props.options||[]).filter((function(t){var n;return n=t.ResultValue,Qe.call(e,n)<0}))).filter((function(e){return""===e.ResultValue})).length&&a.push({ResultValue:"",ResultText:""}),t=0,n=(s=a.sort((function(e,t){var n,r;return(n=e.ResultText)>(r=t.ResultText)?1:n<r?-1:0}))).length;t<n;t++)l=(r=s[t]).ResultValue,c=r.ResultText,i.push(o.a.createElement("option",{value:l},c));return i}},{key:"to_array",value:function(e){return e?Array.isArray(e)?e:(e=(e=(e="".concat(e)).split("u'").join("'")).split("'").join(""),JSON.parse(e)):[]}},{key:"build_selectors",value:function(){var e,t,n,r,i,a,s,c;for(c=(c=this.to_array(this.state.value)).filter((function(e){return""!==e})),t=[],this.props.duplicates?c.push(""):(t=c,i=this.props.options||[],c.length<i.length&&c.push("")),s=[],n=0,r=c.length;n<r;n++)a=c[n],console.log("MultiSelect::build_selectors:value='".concat(a,"'")),e=t.filter((function(e){return e!==a})),s.push(o.a.createElement("li",{key:a},o.a.createElement("select",Be({value:a,onChange:this.props.onChange||this.on_change,className:this.props.className},this.props.attrs),this.build_options(e))));return s}},{key:"render",value:function(){return o.a.createElement("div",{className:"multiselect"},this.props.before&&o.a.createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),o.a.createElement("ul",{className:"list-unstyled",uid:this.props.uid,column_key:this.props.column_key,name:this.props.name,tabIndex:this.props.tabIndex},this.build_selectors()),this.props.after&&o.a.createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&Ue(t.prototype,n),r&&Ue(t,r),a}(o.a.Component);function $e(e){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function We(){return(We=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ot(e);if(t){var o=ot(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nt(this,n)}}function nt(e,t){return!t||"object"!==$e(t)&&"function"!=typeof t?rt(e):t}function rt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ot(e){return(ot=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var it=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}(a,e);var t,n,r,i=tt(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={value:e.defaultValue},t.on_blur=t.on_blur.bind(rt(t)),t.on_change=t.on_change.bind(rt(t)),t}return t=a,(n=[{key:"componentDidUpdate",value:function(e){if(this.props.defaultValue!==e.defaultValue)return this.setState({value:this.props.defaultValue})}},{key:"on_blur",value:function(e){var t,n,r,o;if(r=(t=e.currentTarget).getAttribute("uid"),n=t.getAttribute("column_key")||t.name,o=(o=t.value).replace(/\.*$/,""),t.value=o,console.debug("NumericField::on_blur: value=".concat(o)),this.props.save_editable_field)return this.props.save_editable_field(r,n,o,this.props.item)}},{key:"on_change",value:function(e){var t,n,r,o;if(r=(t=e.currentTarget).getAttribute("uid"),n=t.getAttribute("column_key")||t.name,o=t.value,o=this.to_float(o),t.value=o,this.setState({value:o}),console.debug("NumericField::on_change: value=".concat(o)),this.props.update_editable_field)return this.props.update_editable_field(r,n,o,this.props.item)}},{key:"to_float",value:function(e){return e=(e=e.replace(/(^[-,<,>]?)(\d*)([\.,]?\d*)(.*)/,"$1$2$3")).replace(",",".")}},{key:"render",value:function(){return o.a.createElement("span",{className:"form-group"},this.props.before&&o.a.createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),o.a.createElement("input",We({type:"text",size:this.props.size||5,uid:this.props.uid,name:this.props.name,value:this.state.value,column_key:this.props.column_key,title:this.props.title,disabled:this.props.disabled,required:this.props.required,className:this.props.className,placeholder:this.props.placeholder,onBlur:this.props.onBlur||this.on_blur,onChange:this.props.onChange||this.on_change,tabIndex:this.props.tabIndex},this.props.attrs)),this.props.after&&o.a.createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&Ye(t.prototype,n),r&&Ye(t,r),a}(o.a.Component);function at(e){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function st(){return(st=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ct(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lt(e,t){return(lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pt(e);if(t){var o=pt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ft(this,n)}}function ft(e,t){return!t||"object"!==at(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pt(e){return(pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var dt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lt(e,t)}(a,e);var t,n,r,i=ut(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"render",value:function(){return o.a.createElement("span",{className:"form-group"},this.props.before&&o.a.createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),o.a.createElement("input",st({type:"text",size:this.props.size||5,uid:this.props.uid,name:this.props.name,value:this.props.value||"",column_key:this.props.column_key,title:this.props.title,disabled:!0,required:this.props.required,className:this.props.className,placeholder:this.props.placeholder},this.props.attrs)),this.props.after&&o.a.createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&ct(t.prototype,n),r&&ct(t,r),a}(o.a.Component);function ht(e){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mt(){return(mt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function bt(e,t){return(bt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kt(e);if(t){var o=kt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vt(this,n)}}function vt(e,t){return!t||"object"!==ht(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kt(e){return(kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bt(e,t)}(a,e);var t,n,r,i=gt(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"is_boolean_field",value:function(){return"boolean"==typeof this.props.value}},{key:"render",value:function(){return this.is_boolean_field()?this.props.value?o.a.createElement("span",null,_t("Yes")):o.a.createElement("span",null,_t("No")):o.a.createElement("span",{className:this.props.className},this.props.before&&o.a.createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),o.a.createElement("span",mt({dangerouslySetInnerHTML:{__html:this.props.formatted_value}},this.props.attrs)),this.props.after&&o.a.createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&yt(t.prototype,n),r&&yt(t,r),a}(o.a.Component);function xt(e){return(xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ot(){return(Ot=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function St(e,t){return(St=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Et(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Nt(e);if(t){var o=Nt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rt(this,n)}}function Rt(e,t){return!t||"object"!==xt(t)&&"function"!=typeof t?Pt(e):t}function Pt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nt(e){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ct=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&St(e,t)}(a,e);var t,n,r,i=Et(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={value:e.defaultValue||""},t.on_blur=t.on_blur.bind(Pt(t)),t.on_change=t.on_change.bind(Pt(t)),t}return t=a,(n=[{key:"componentDidUpdate",value:function(e){if(this.props.defaultValue!==e.defaultValue)return this.setState({value:this.props.defaultValue})}},{key:"on_blur",value:function(e){var t,n,r,o;if(r=(t=e.currentTarget).getAttribute("uid"),n=t.getAttribute("column_key")||t.name,o=t.value,this.setState({value:o}),console.debug("Select::on_blur: value=".concat(o)),this.props.save_editable_field)return this.props.save_editable_field(r,n,o,this.props.item)}},{key:"on_change",value:function(e){var t,n,r,o;if(r=(t=e.currentTarget).getAttribute("uid"),n=t.getAttribute("column_key")||t.name,(o=t.value)!==this.state.value)return console.debug("Select::on_change: value=".concat(o)),this.setState({value:o}),this.props.update_editable_field?this.props.update_editable_field(r,n,o,this.props.item):void 0}},{key:"build_options",value:function(){var e,t,n,r,i,a,s;for(r=[],e=0,t=(i=this.props.options.sort((function(e,t){var n,r;return(n=e.ResultText)>(r=t.ResultText)?1:n<r?-1:0}))).length;e<t;e++)s=(n=i[e]).ResultValue,a=n.ResultText,r.push(o.a.createElement("option",{key:s,value:s},a));return r}},{key:"render",value:function(){return o.a.createElement("span",{className:"form-group"},this.props.before&&o.a.createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),o.a.createElement("select",Ot({key:this.props.name,uid:this.props.uid,name:this.props.name,value:this.state.value,column_key:this.props.column_key,title:this.props.title,disabled:this.props.disabled,onBlur:this.props.onBlur||this.on_blur,onChange:this.props.onChange||this.on_change,required:this.props.required,className:this.props.className,tabIndex:this.props.tabIndex},this.props.attrs),this.build_options()),this.props.after&&o.a.createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&jt(t.prototype,n),r&&jt(t,r),a}(o.a.Component);function Tt(e){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dt(){return(Dt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function It(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Lt(e,t){return(Lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function At(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=zt(e);if(t){var o=zt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Mt(this,n)}}function Mt(e,t){return!t||"object"!==Tt(t)&&"function"!=typeof t?qt(e):t}function qt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zt(e){return(zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ht=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lt(e,t)}(a,e);var t,n,r,i=At(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).state={value:e.defaultValue},t.on_change=t.on_change.bind(qt(t)),t}return t=a,(n=[{key:"componentDidUpdate",value:function(e){if(this.props.defaultValue!==e.defaultValue)return this.setState({value:this.props.defaultValue})}},{key:"on_change",value:function(e){var t,n,r,o;if(r=(t=e.currentTarget).getAttribute("uid"),n=t.getAttribute("column_key")||t.name,o=t.value,this.setState({value:o}),console.debug("StringField::on_change: value=".concat(o)),this.props.update_editable_field)return this.props.update_editable_field(r,n,o,this.props.item)}},{key:"render",value:function(){return o.a.createElement("span",{className:"form-group"},this.props.before&&o.a.createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),o.a.createElement("input",Dt({type:"text",size:this.props.size||20,uid:this.props.uid,name:this.props.name,value:this.state.value,column_key:this.props.column_key,title:this.props.title,disabled:this.props.disabled,required:this.props.required,className:this.props.className,placeholder:this.props.placeholder,onChange:this.props.onChange||this.on_change,tabIndex:this.props.tabIndex},this.props.attrs)),this.props.after&&o.a.createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&It(t.prototype,n),r&&It(t,r),a}(o.a.Component);function Vt(e){return(Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(){return(Bt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ft(e,t){return(Ft=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zt(e);if(t){var o=Zt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jt(this,n)}}function Jt(e,t){return!t||"object"!==Vt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zt(e){return(Zt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gt=[].indexOf,Qt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ft(e,t)}(a,e);var t,n,r,i=Xt(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).ZPUBLISHER_CONVERTER={boolean:":record:ignore_empty",select:":records",choices:":records",multiselect:":record:list",multichoice:":record:list",numeric:":records",string:":records",readonly:"",default:":records"},t}return t=a,(n=[{key:"get_item",value:function(){return this.props.item}},{key:"get_column_key",value:function(){return this.props.column_key}},{key:"render_before_content",value:function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n=this.get_column_key(),r=this.get_item())return n in(e=r.before)?(t=r.before_components||{},o.a.createElement("span",{key:n+"_before",className:"before-item"},t[n],o.a.createElement("span",Bt({dangerouslySetInnerHTML:{__html:e[n]}},i)))):null}},{key:"render_after_content",value:function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n=this.get_column_key(),r=this.get_item())return n in(e=r.after)?(t=r.after_components||{},o.a.createElement("span",{key:n+"_after",className:"after-item"},t[n],o.a.createElement("span",Bt({dangerouslySetInnerHTML:{__html:e[n]}},i)))):null}},{key:"is_edit_allowed",value:function(){var e,t;return e=this.get_column_key(),t=this.get_item(),!!this.props.allow_edit&&Gt.call(t.allow_edit,e)>=0}},{key:"is_disabled",value:function(){return this.get_item().disabled||!1}},{key:"is_required",value:function(){var e,t,n,r;return e=this.get_column_key(),n=this.get_item().required||[],t=Gt.call(n,e)>=0,r=this.props.selected,t&&r}},{key:"get_name",value:function(){var e,t;return t=this.get_uid(),e=this.get_column_key(),"".concat(e,".").concat(t)}},{key:"get_uid",value:function(){return this.get_item().uid}},{key:"is_selected",value:function(){var e;return e=this.get_item().uid,Gt.call(this.props.selected_uids,e)>=0}},{key:"get_value",value:function(){var e,t,n;return e=this.get_column_key(),n=this.get_item()[e],(t=this.get_interimfields()).hasOwnProperty(e)&&(n=t[e].value||""),null===n&&(n=""),n}},{key:"get_formatted_unit",value:function(){var e,t,n;return e=this.get_column_key(),n=(t=this.get_item()).Unit,this.is_interimfield()&&(n=t[e].unit),n?"<span class='unit'>".concat(n,"</span>"):""}},{key:"get_interimfields",value:function(){var e,t;return e=this.get_item().interimfields||[],t={},e.map((function(e,n){return t[e.keyword]=e})),t}},{key:"is_interimfield",value:function(){var e;return e=this.get_column_key(),this.get_interimfields().hasOwnProperty(e)}},{key:"get_choices",value:function(){return this.get_item().choices||{}}},{key:"is_result_column",value:function(){return"Result"===this.get_column_key()}},{key:"get_formatted_value",value:function(){var e,t,n;return e=this.get_column_key(),t=(n=this.get_item()).replace[e]||this.get_value(),this.is_result_column()?(t=n.formatted_result||t)&&(t+=this.get_formatted_unit()):this.is_interimfield()&&t&&(t+=this.get_formatted_unit()),t}},{key:"get_type",value:function(){var e,t,n,r,o;return t=this.get_column_key(),r=this.get_item(),n=this.is_edit_allowed(),o=this.is_result_column(),n?o&&r.calculation?"calculated":"type"in(e=this.props.column||{})?e.type:"boolean"==typeof this.get_value()?"boolean":t in this.get_choices()?o&&r.result_type||"select":this.is_interimfield()?"interim":o&&r.result_type||"numeric":"readonly"}},{key:"create_readonly_field",value:function(){var e,t,n,r,i,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=a.props;return this.get_column_key(),this.get_item(),null==s&&(s={}),n=this.get_name(),i=this.get_value(),t=this.get_formatted_value(),r=this.get_uid(),e="readonly",o.a.createElement(wt,Bt({key:n,uid:r,name:n,value:i,formatted_value:t,className:e},s))}},{key:"create_calculated_field",value:function(){var e,t,n,r,i,a,s,c,l,u,f,p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=p.props;return e=this.get_column_key(),r=this.get_item(),null==d&&(d={}),i=this.get_name(),f=this.get_value(),n=this.get_formatted_value(),u=this.get_formatted_unit(),l=this.get_uid(),c=this.props.column.title||e,s=this.is_selected(),t="form-control input-sm calculated",(a=this.is_required())&&(t+=" required"),o.a.createElement(dt,Bt({key:i,uid:l,item:r,name:i,value:f,column_key:e,title:c,formatted_value:n,placeholder:c,selected:s,required:a,className:t,after:u,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field},d))}},{key:"create_hidden_field",value:function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.props;return e=this.get_column_key(),this.get_item(),null==a&&(a={}),t=this.get_name(),r=this.get_value(),this.get_formatted_value(),n=this.get_uid(),this.props.column.title,o.a.createElement(Ce,Bt({key:t+"_hidden",uid:n,name:t,value:r,column_key:e},a))}},{key:"create_numeric_field",value:function(){var e,t,n,r,i,a,s,c,l,u,f,p,d,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_=h.props;return e=this.get_column_key(),a=this.get_item(),null==_&&(_={}),s=this.get_name(),d=this.get_value(),i=this.get_formatted_value(),p=this.get_formatted_unit(),f=this.get_uid(),r=s+this.ZPUBLISHER_CONVERTER.numeric,u=this.props.column.title||e,l=this.is_selected(),n=this.is_disabled(),t="form-control input-sm",(c=this.is_required())&&(t+=" required"),o.a.createElement(it,Bt({key:s,uid:f,item:a,name:r,defaultValue:d,column_key:e,title:u,formatted_value:i,placeholder:u,selected:l,disabled:n,required:c,className:t,after:p,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},_))}},{key:"create_string_field",value:function(){var e,t,n,r,i,a,s,c,l,u,f,p,d,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_=h.props;return e=this.get_column_key(),a=this.get_item(),null==_&&(_={}),s=this.get_name(),d=this.get_value(),i=this.get_formatted_value(),p=this.get_formatted_unit(),f=this.get_uid(),r=s+this.ZPUBLISHER_CONVERTER.string,u=this.props.column.title||e,l=this.is_selected(),n=this.is_disabled(),t="form-control input-sm",(c=this.is_required())&&(t+=" required"),o.a.createElement(Ht,Bt({key:s,uid:f,item:a,name:r,defaultValue:d,column_key:e,title:u,formatted_value:i,placeholder:u,selected:l,disabled:n,required:c,className:t,after:p,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},_))}},{key:"create_select_field",value:function(){var e,t,n,r,i,a,s,c,l,u,f,p,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=d.props;return e=this.get_column_key(),i=this.get_item(),null==h&&(h={}),a=this.get_name(),p=this.get_value(),s=i.choices[e]||[],this.get_formatted_value(),f=this.get_uid(),r=a+this.ZPUBLISHER_CONVERTER.select,u=this.props.column.title||e,l=this.is_selected(),n=this.is_disabled(),t="form-control input-sm",(c=this.is_required())&&(t+=" required"),o.a.createElement(Ct,Bt({key:a,uid:f,item:i,name:r,defaultValue:p,column_key:e,title:u,disabled:n,selected:l,required:c,options:s,className:t,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},h))}},{key:"create_multichoice_field",value:function(){var e,t,n,r,i,a,s,c,l,u,f,p,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=d.props;return e=this.get_column_key(),i=this.get_item(),null==h&&(h={}),a=this.get_name(),p=this.get_value(),s=i.choices[e]||[],this.get_formatted_value(),f=this.get_uid(),r=a+this.ZPUBLISHER_CONVERTER.multichoice,u=this.props.column.title||e,l=this.is_selected(),n=this.is_disabled(),t="form-control input-sm",(c=this.is_required())&&(t+=" required"),o.a.createElement(He,Bt({key:a,uid:f,item:i,name:r,defaultValue:p,column_key:e,title:u,disabled:n,selected:l,required:c,options:s,className:t,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},h))}},{key:"create_multiselect_field",value:function(){var e,t,n,r,i,a,s,c,l,u,f,p,d,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_=h.props;return e=this.get_column_key(),a=this.get_item(),null==_&&(_={}),p=this.get_uid(),s=this.get_name(),d=this.get_value(),c=a.choices[e]||[],this.get_formatted_value(),i=s+this.ZPUBLISHER_CONVERTER.multiselect,f=this.props.column.title||e,u=this.is_selected(),n=this.is_disabled(),l=this.is_required(),r="multiselect_duplicates"===a.result_type,t="form-control input-sm",l&&(t+=" required"),o.a.createElement(Ke,Bt({key:s,uid:p,item:a,name:i,defaultValue:d,value:d,column_key:e,title:f,disabled:n,selected:u,required:l,options:c,duplicates:r,className:t,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},_))}},{key:"create_checkbox_field",value:function(){var e,t,n,r,i,a,s,c,l,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=u.props;return e=this.get_column_key(),i=this.get_item(),null==f&&(f={}),a=this.get_name(),l=this.get_value(),i.choices[e],this.get_formatted_value(),c=this.get_uid(),r=a+this.ZPUBLISHER_CONVERTER.boolean,s=this.props.column.title||e,this.is_selected(),n=this.is_disabled(),t="checkbox",this.is_required()&&(t+=" required"),o.a.createElement(ae,Bt({key:a,uid:c,item:i,name:r,value:"on",column_key:e,title:s,defaultChecked:l,disabled:n,className:t,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field},f))}},{key:"render_content",value:function(){var e,t,n;return e=this.get_column_key(),this.get_item()?(this.get_uid(),t=[],"readonly"===(n=this.get_type())?t=t.concat(this.create_readonly_field()):"calculated"===n?t=t.concat(this.create_calculated_field()):"interim"===n?t=t.concat(this.create_numeric_field()):"select"===n||"choices"===n?t=t.concat(this.create_select_field()):"multichoice"===n?t=t.concat(this.create_multichoice_field()):"multiselect"===n||"multiselect_duplicates"===n?t=t.concat(this.create_multiselect_field()):"boolean"===n?t=t.concat(this.create_checkbox_field()):"numeric"===n?t=t.concat(this.create_numeric_field()):"string"===n&&(t=t.concat(this.create_string_field())),t):(console.warn("Skipping empty folderitem for column '".concat(e,"'")),null)}},{key:"render",value:function(){return o.a.createElement("td",{className:this.props.className,colSpan:this.props.colspan,rowSpan:this.props.rowspan},o.a.createElement("div",{className:"form-group"},this.render_before_content(),this.render_content(),this.render_after_content()))}}])&&Ut(t.prototype,n),r&&Ut(t,r),a}(o.a.Component);function Kt(e){return(Kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $t(){return($t=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Wt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Yt(e,t){return(Yt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function en(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rn(e);if(t){var o=rn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return tn(this,n)}}function tn(e,t){return!t||"object"!==Kt(t)&&"function"!=typeof t?nn(e):t}function nn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rn(e){return(rn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var on=[].indexOf,an=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Yt(e,t)}(a,e);var t,n,r,i=en(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_blur=t.on_blur.bind(nn(t)),t.on_change=t.on_change.bind(nn(t)),t}return t=a,(n=[{key:"on_blur",value:function(e){var t,n,r,o;if(r=(t=e.currentTarget).getAttribute("uid"),n=t.getAttribute("column_key")||t.name,o=t.value,console.debug("RemarksField:on_blur: value=".concat(o)),this.props.save_editable_field)return this.props.save_editable_field(r,n,o,this.props.item)}},{key:"on_change",value:function(e){var t,n,r,o;if(r=(t=e.currentTarget).getAttribute("uid"),n=t.getAttribute("column_key")||t.name,o=t.value,console.debug("RemarksField:on_change: value=".concat(o)),this.props.update_editable_field)return this.props.update_editable_field(r,n,o,this.props.item)}},{key:"can_edit",value:function(){var e,t,n;return n=this.props.item,t=this.props.column_key,e=n.allow_edit||[],on.call(e,t)>=0}},{key:"get_column_title",value:function(){var e;return e=this.props.columns[this.props.column_key].title||"Remarks","function"==typeof _&&(e=_(e)),e}},{key:"get_style",value:function(){var e;return e=this.props.uid,{display:on.call(this.props.expanded_remarks,e)>=0||this.props.value.length>0?"block":"none"}}},{key:"render_remarks_field",value:function(){var e,t,n,r;return n=this.props.uid,e=this.props.column_key,t="".concat(e,".").concat(n,":records"),r=this.props.value,this.can_edit()?o.a.createElement("textarea",$t({className:"remarksfield form-control",uid:n,column_key:e,style:{width:"100%"},rows:this.props.rows||2,name:t,onBlur:this.props.onBlur||this.on_blur,onChange:this.props.onChange||this.on_change,defaultValue:r,tabIndex:this.props.tabIndex},this.props.attrs)):o.a.createElement("span",{className:"remarksfield",dangerouslySetInnerHTML:{__html:r}})}},{key:"render",value:function(){return this.props.uid?o.a.createElement("div",{style:this.get_style(),className:"remarks text-muted"},this.props.before&&o.a.createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),o.a.createElement("div",{className:"text-info"},o.a.createElement("i",{className:"fas fa-hand-point-right"})," ",this.get_column_title(),":"),this.render_remarks_field(),this.props.after&&o.a.createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}})):null}}])&&Wt(t.prototype,n),r&&Wt(t,r),a}(o.a.Component);function sn(e){return(sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cn(){return(cn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ln(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fn(e,t){return(fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hn(e);if(t){var o=hn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return dn(this,n)}}function dn(e,t){return!t||"object"!==sn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hn(e){return(hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _n=[].indexOf,mn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fn(e,t)}(a,e);var t,n,r,i=pn(a);function a(){return ln(this,a),i.apply(this,arguments)}return t=a,(n=[{key:"get_item",value:function(){return this.props.item[this.props.column_key]}},{key:"get_column_key",value:function(){return this.props.item.item_key||this.props.item.column_key}},{key:"get_css",value:function(){var e,t,n;return t=this.get_item(),e=["transposed",this.props.className],this.is_result_column()&&e.push("result"),t?(e.push(t.state_class),n=t.uid,_n.call(this.props.selected_uids,n)>=0&&e.push("info")):e.push("empty"),e.join(" ")}},{key:"get_remarks_columns",value:function(){var e,t,n;for(t in e=[],n=this.props.columns)"remarks"===n[t].type&&e.push(t);return e}},{key:"create_select_checkbox",value:function(){var e,t,n,r,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=i.props;return null==a&&(a={}),r=this.get_uid(),t="".concat(this.props.select_checkbox_name,":list"),e=this.is_disabled(),n=this.is_selected(),o.a.createElement("div",{key:"select",className:"checkbox"},o.a.createElement(ae,cn({name:t,value:r,disabled:e,checked:n,onChange:this.props.on_select_checkbox_checked},a)))}},{key:"create_interim_fields",value:function(){var e,t,n,r,o,i,a,s,c,l,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=u.props;for(null==f&&(f={}),c=this.get_uid(),e=[],n=t=0,a=(o=this.get_item().interimfields||[]).length;t<a;n=++t)i=(r=o[n]).keyword,this.props.columns.hasOwnProperty(i)&&(l=r.unit||"",s=r.title||i,f={key:i,column_key:i,name:"".concat(i,".").concat(c),defaultValue:r.value,placeholder:s,formatted_value:r.formatted_value,before:"<span>".concat(s,"</span>"),after:"<span>".concat(l,"</span>")},this.is_edit_allowed()?(f.className="form-control input-sm interim",e=e.concat(this.create_numeric_field({props:f}))):(f.className="readonly interim",e=e.concat(this.create_readonly_field({props:f}))));return e}},{key:"render_content",value:function(){var e,t,n,r,i,a,s,c,l,u,f;if(n=this.get_column_key(),!(a=this.get_item()))return console.debug("Skipping empty item for '".concat(n,"' in column '").concat(this.props.column_key,"'")),null;if(f=this.get_uid(),u=this.get_type(),r=[],this.is_result_column){l=this.props.columns.Result.title,(e={})[n]=[this.create_select_checkbox()],this.get_remarks_columns().length>0&&e[n].push(o.a.createElement("a",{key:f+"_remarks",href:"#",className:"transposed_remarks",uid:f,onClick:this.props.on_remarks_expand_click},o.a.createElement("i",{className:"remarksicon fas fa-comment"}))),a.before_components=e,"readonly"===u?r=(r=r.concat(this.create_interim_fields())).concat(this.create_readonly_field()):(r=r.concat(this.create_interim_fields()),r="calculated"===u?r.concat(this.create_calculated_field({props:{before:"<span>".concat(l,"</span>"),after:"<span>".concat(a.Unit||"","</span>")}})):n in this.get_choices()?r.concat(this.create_select_field()):r.concat(this.create_numeric_field()));for(t=i=0,s=(c=this.get_remarks_columns()).length;i<s;t=++i)a[n=c[t]],r.push(o.a.createElement("div",{key:t+"_remarks"},o.a.createElement(an,cn({},this.props,{uid:f,item:a,column_key:n,value:a[n]}))));return a.replace.Attachments&&(r=r.concat(this.create_readonly_field({props:{key:t+"_attachments",uid:f,item:a,column_key:"Attachments",formatted_value:a.replace.Attachments,attrs:{style:{display:"block"}}}}))),r}}},{key:"render",value:function(){return o.a.createElement("td",{className:this.get_css(),colSpan:this.props.colspan,rowSpan:this.props.rowspan},o.a.createElement("div",{className:"form-group"},this.render_before_content(),this.render_content(),this.render_after_content()))}}])&&un(t.prototype,n),r&&un(t,r),a}(Qt);function yn(e){return(yn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bn(){return(bn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function vn(e,t){return(vn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=On(e);if(t){var o=On(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return wn(this,n)}}function wn(e,t){return!t||"object"!==yn(t)&&"function"!=typeof t?xn(e):t}function xn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function On(e){return(On=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var jn=[].indexOf,Sn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vn(e,t)}(a,e);var t,n,r,i=kn(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_remarks_expand_click=t.on_remarks_expand_click.bind(xn(t)),t}return t=a,(n=[{key:"on_remarks_expand_click",value:function(e){var t;if(e.preventDefault(),t=e.currentTarget.getAttribute("uid"),this.props.on_remarks_expand_click)return this.props.on_remarks_expand_click(t)}},{key:"get_column",value:function(e){return this.props.columns[e]}},{key:"get_item",value:function(){return this.props.item}},{key:"get_uid",value:function(){return this.get_item().uid}},{key:"get_tab_index",value:function(e,t){return 100*this.props.row_index+t}},{key:"get_colspan",value:function(e,t){return(t.colspan||{})[e]}},{key:"get_rowspan",value:function(e,t){return(t.rowspan||{})[e]}},{key:"skip_cell_rendering",value:function(e){var t;return t=this.get_item().skip||[],jn.call(t,e)>=0}},{key:"show_select",value:function(){var e;return"boolean"==typeof(e=this.get_item()).show_select?e.show_select:this.props.show_select_column}},{key:"is_transposed",value:function(e){return"transposed"===this.get_column(e).type}},{key:"create_select_cell",value:function(){var e,t,n;return e="".concat(this.props.select_checkbox_name,":list"),this.get_item(),n=this.get_uid(),t=this.props.remarks,o.a.createElement("td",{key:n},o.a.createElement(ae,{name:e,value:n,disabled:this.props.disabled,checked:this.props.selected,onChange:this.props.on_select_checkbox_checked}),t&&o.a.createElement("a",{uid:n,href:"#",className:"remarks",onClick:this.on_remarks_expand_click},o.a.createElement("span",{className:"remarksicon fas fa-comment-alt"})))}},{key:"create_regular_cell",value:function(e,t){var n,r,i,a,s;return a=this.get_item(),r=this.get_column(e),n=this.get_colspan(e,a),s=this.get_rowspan(e,a),i="contentcell ".concat(e),o.a.createElement(Qt,bn({},this.props,{key:t,item:a,column_key:e,column_index:t,column:r,colspan:n,rowspan:s,className:i,tabIndex:this.get_tab_index(e,t)}))}},{key:"create_transposed_cell",value:function(e,t){var n,r,i,a,s;return a=this.get_item(),r=this.get_column(e),n=this.get_colspan(e,a),s=this.get_rowspan(e,a),i="contentcell ".concat(e),o.a.createElement(mn,bn({},this.props,{key:t,item:a,column_key:e,column_index:t,column:r,colspan:n,rowspan:s,on_remarks_expand_click:this.on_remarks_expand_click,className:i,tabIndex:this.get_tab_index(e,t)}))}},{key:"build_cells",value:function(){var e,t,n,r,o,i;for(e=[],this.show_select()&&e.push(this.create_select_cell()),t=r=0,o=(i=this.props.visible_columns).length;r<o;t=++r)n=i[t],this.skip_cell_rendering(n)||(this.is_transposed(n)?e.push(this.create_transposed_cell(n,t)):e.push(this.create_regular_cell(n,t)));return e}},{key:"render",value:function(){return this.build_cells()}}])&&gn(t.prototype,n),r&&gn(t,r),a}(o.a.Component);function En(e){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Pn(e,t){return(Pn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Tn(e);if(t){var o=Tn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cn(this,n)}}function Cn(e,t){return!t||"object"!==En(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tn(e){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pn(e,t)}(a,e);var t,n,r,i=Nn(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"render",value:function(){return o.a.createElement("tr",{className:this.props.className,onClick:this.props.onClick,category:this.props.category,uid:this.props.uid},o.a.createElement(Sn,this.props))}}])&&Rn(t.prototype,n),r&&Rn(t,r),a}(o.a.Component);function In(e){return(In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function An(e,t){return(An=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Hn(e);if(t){var o=Hn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qn(this,n)}}function qn(e,t){return!t||"object"!==In(t)&&"function"!=typeof t?zn(e):t}function zn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Hn(e){return(Hn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&An(e,t)}(a,e);var t,n,r,i=Mn(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_category_click=t.on_category_click.bind(zn(t)),t}return t=a,(n=[{key:"on_category_click",value:function(e){var t;if(t=e.currentTarget.getAttribute("category"),console.debug("TableCategoryRow::on_row_click: category ".concat(t," clicked")),this.props.on_category_click)return this.props.on_category_click(t)}},{key:"build_category",value:function(){var e,t;return e="collapsed",t="fas fa-caret-square-up",this.props.expanded&&(e="expanded",t="fas fa-caret-square-down"),o.a.createElement("td",{key:"toggle",className:e,colSpan:this.props.columns_count},o.a.createElement("span",{className:t})," ",this.props.category)}},{key:"render",value:function(){return o.a.createElement("tr",{category:this.props.category,onClick:this.on_category_click,className:this.props.className},this.build_category())}}])&&Ln(t.prototype,n),r&&Ln(t,r),a}(o.a.Component);function Bn(e){return(Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Un(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fn(e,t){return(Fn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Zn(e);if(t){var o=Zn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Jn(this,n)}}function Jn(e,t){return!t||"object"!==Bn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zn(e){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Gn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fn(e,t)}(a,e);var t,n,r,i=Xn(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"render",value:function(){return o.a.createElement("tr",{className:this.props.className},o.a.createElement("td",{style:{padding:0,borderTop:0}}),o.a.createElement("td",{style:{padding:0,borderTop:0},colSpan:this.props.colspan-1},o.a.createElement(an,this.props)))}}])&&Un(t.prototype,n),r&&Un(t,r),a}(o.a.Component);function Qn(e){return(Qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kn(){return(Kn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function $n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wn(e,t){return(Wn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=nr(e);if(t){var o=nr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return er(this,n)}}function er(e,t){return!t||"object"!==Qn(t)&&"function"!=typeof t?tr(e):t}function tr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nr(e){return(nr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rr=[].indexOf,or=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wn(e,t)}(a,e);var t,n,r,i=Yn(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_row_expand_click=t.on_row_expand_click.bind(tr(t)),t}return t=a,(n=[{key:"on_row_expand_click",value:function(e){var t,n,r;if(t=(n=e.currentTarget).children.item(0),e.target===t&&(r=n.getAttribute("uid"),this.props.on_row_expand_click))return this.props.on_row_expand_click(r)}},{key:"is_selected",value:function(e){var t,n;return n=e.uid,t=this.props.selected_uids||[],rr.call(t,n)>=0}},{key:"is_expanded",value:function(e){var t,n;return t=this.props.expanded_rows||[],n=e.uid,rr.call(t,n)>=0}},{key:"get_children",value:function(e){var t;return t=e.uid,(this.props.children||{})[t]||[]}},{key:"is_category_expanded",value:function(e){return rr.call(this.props.expanded_categories,e)>=0}},{key:"is_item_disabled",value:function(e){return e.disabled||!1}},{key:"is_child_item",value:function(e){if(e.parent)return!0}},{key:"get_item_category",value:function(e){return e.category||null}},{key:"get_item_children",value:function(e){return e.children||[]}},{key:"has_item_children",value:function(e){return this.get_item_children(e).length>0}},{key:"get_remarks_columns",value:function(e){var t,n,r;for(n in t=[],r=this.props.columns)if("remarks"===r[n].type){if(void 0===e[n])continue;t.push(n)}return t}},{key:"get_item_uid",value:function(e){return e.uid}},{key:"get_item_css",value:function(e){var t;return t=["contentrow"],e.state_class&&(t=t.concat(e.state_class.split(" "))),this.is_selected(e)&&t.push("table-info"),this.is_child_item(e)?t.push("child"):t.push("parent"),this.has_item_children(e)&&(this.is_expanded(e)?t.push("expanded"):t.push("collapsed")),t.join(" ")}},{key:"render_categorized_rows",value:function(){var e,t,n,r,i,a;if(a=[],this.props.show_categories)for(n=0,r=(i=this.props.categories).length;n<r;n++)e=i[n],t=this.is_category_expanded(e),a.push(o.a.createElement(Vn,Kn({},this.props,{key:e,category:e,expanded:t,className:"categoryrow"}))),a=a.concat(this.build_rows({props:{category:e}}));else a=this.build_rows();return a}},{key:"build_rows",value:function(){var e,t,n,r,i,a,s,c,l,u,f,p,d,h,_,m,y,b,g,v,k,w,x,O,j=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},S=j.props;for(g=[],null==S&&(S={}),e=S.category||null,h=p=0,m=(f=S.folderitems||this.props.folderitems).length;p<m;h=++p)if(d=f[h],(!e||this.get_item_category(d)===e)&&(!e||this.is_category_expanded(e)||this.is_selected(d))){for(x=this.get_item_uid(d),s=this.get_item_css(d),n=this.get_item_children(d),u=this.is_expanded(d),v=this.is_selected(d),c=this.is_item_disabled(d),l=this.has_item_children(d),b=this.get_remarks_columns(d),w=!1,null===x&&(w=!0,x=h),g.push(o.a.createElement(Dn,Kn({},this.props,{key:x,item:d,uid:x,category:e,expanded:u,remarks:b.length>0,selected:v,disabled:c,className:s,onClick:l&&this.on_row_expand_click||void 0,row_index:h}))),i=_=0,y=b.length;_<y&&(a=b[i],!w);i=++_)this.props.columns[a],k=d.skip||[],r=this.props.columns_count-k.length,O=d[a]||"",g.push(o.a.createElement(Gn,Kn({},this.props,{key:"remarks_"+h,uid:x,item:d,column_key:a,value:O,expanded:u,selected:v,disabled:c,className:s+" remarksrow",colspan:r,row_index:h})));u&&(n=this.get_children(d)).length>0&&(t=this.build_rows({props:{category:e,folderitems:n}}),g=g.concat(t))}return g}},{key:"render",value:function(){return this.render_categorized_rows()}}])&&$n(t.prototype,n),r&&$n(t,r),a}(o.a.Component);function ir(e){return(ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sr(e,t){return(sr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ur(e);if(t){var o=ur(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lr(this,n)}}function lr(e,t){return!t||"object"!==ir(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ur(e){return(ur=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var fr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sr(e,t)}(a,e);var t,n,r,i=cr(a);function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),i.call(this,e)}return t=a,(n=[{key:"render",value:function(){return o.a.createElement("table",{id:this.props.id,className:this.props.className},o.a.createElement("thead",null,o.a.createElement(xe,this.props)),o.a.createElement("tbody",null,o.a.createElement(or,this.props)))}}])&&ar(t.prototype,n),r&&ar(t,r),a}(o.a.Component);function pr(e){return(pr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function hr(e,t){return(hr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _r(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=br(e);if(t){var o=br(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mr(this,n)}}function mr(e,t){return!t||"object"!==pr(t)&&"function"!=typeof t?yr(e):t}function yr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function br(e){return(br=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hr(e,t)}(a,e);var t,n,r,i=_r(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).on_drag_start=t.on_drag_start.bind(yr(t)),t.on_drag_end=t.on_drag_end.bind(yr(t)),t.on_drag_over=t.on_drag_over.bind(yr(t)),t.on_column_toggle_click=t.on_column_toggle_click.bind(yr(t)),t.on_reset_click=t.on_reset_click.bind(yr(t)),t.state={columns_order:t.props.columns_order},t}return t=a,(n=[{key:"componentDidUpdate",value:function(e,t,n){if(this.props.columns_order!==e.columns_order)return this.setState({columns_order:this.props.columns_order})}},{key:"on_reset_click",value:function(e){if(e.preventDefault(),this.props.on_column_toggle_click)return this.props.on_column_toggle_click("reset")}},{key:"on_drag_start",value:function(e){return this.dragged_item=e.currentTarget,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.dragged_item),e.dataTransfer.setDragImage(this.dragged_item,50,0)}},{key:"on_drag_over",value:function(e){var t,n,r,o,i;if((i=e.currentTarget)!==this.dragged_item)return t=this.dragged_item.getAttribute("column"),n=i.getAttribute("column"),o=(r=this.state.columns_order).indexOf(n),(r=r.filter((function(e){return e!==t}))).splice(o,0,t),this.setState({columns_order:r})}},{key:"on_drag_end",value:function(e){if(this.dragged_item=null,this.props.on_columns_order_change)return this.props.on_columns_order_change(this.state.columns_order)}},{key:"on_column_toggle_click",value:function(e){var t;if(e.preventDefault(),t=e.currentTarget.getAttribute("column"),this.props.on_column_toggle_click)return this.props.on_column_toggle_click(t)}},{key:"is_column_visible",value:function(e){return!1!==e.toggle}},{key:"build_column_toggles",value:function(){var e,t,n,r,i,a,s;for(t=[],n=0,i=(a=this.state.columns_order).length;n<i;n++)r=a[n],e=this.props.columns[r],s=this.is_column_visible(e),t.push(o.a.createElement("li",{key:r,column:r,style:{padding:"0 5px 5px 0"},className:"column",onDragOver:this.on_drag_over},o.a.createElement("a",{href:"#",column:r,className:"draggable-column",onDragStart:this.on_drag_start,onDragEnd:this.on_drag_end,draggable:!0},o.a.createElement("span",{column:r,onClick:this.on_column_toggle_click,className:"nav-item btn btn-light btn-sm"},s&&o.a.createElement("i",{className:"text-primary fas fa-check-square"}),!s&&o.a.createElement("i",{className:"text-muted fas fa-square"})," ",o.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.title||r}})))));return t}},{key:"render",value:function(){return o.a.createElement("div",{id:this.props.id,className:this.props.className},o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-12 text-left my-3"},o.a.createElement("strong",null,this.props.title),o.a.createElement("div",{className:"help-block"},this.props.description),o.a.createElement("ul",{className:"list-inline nav nav-pills"},this.build_column_toggles(),o.a.createElement("li",{key:"reset",style:{padding:"0 5px 5px 0"}},o.a.createElement("button",{onClick:this.on_reset_click,className:"btn btn-warning btn-sm"},_t("Reset Columns")))))))}}])&&dr(t.prototype,n),r&&dr(t,r),a}(o.a.Component);n(9);function vr(e){return(vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wr(e,t){return(wr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Sr(e);if(t){var o=Sr(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Or(this,n)}}function Or(e,t){return!t||"object"!==vr(t)&&"function"!=typeof t?jr(e):t}function jr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Sr(e){return(Sr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Er,Rr=[].indexOf;document.addEventListener("DOMContentLoaded",(function(){var e,t,n,r,i,s,c;for(console.debug("*** SENAITE.APP.LISTING::DOMContentLoaded: --\x3e Loading ReactJS Controller"),null==window._t&&(console.warn("Global translation variable `_t` not found! Translations won't work!"),window._t=function(e){return e}),c=document.getElementsByClassName("ajax-contents-table"),null==window.listings&&(window.listings={}),i=[],n=0,r=c.length;n<r;n++)t=(s=c[n]).dataset.form_id,e=a.a.render(o.a.createElement(Er,{root_el:s}),s),i.push(window.listings[t]=e);return i})),Er=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wr(e,t)}(a,e);var t,n,r,i=xr(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e)).dismissMessage=t.dismissMessage.bind(jr(t)),t.doAction=t.doAction.bind(jr(t)),t.filterBySearchterm=t.filterBySearchterm.bind(jr(t)),t.filterByState=t.filterByState.bind(jr(t)),t.on_api_error=t.on_api_error.bind(jr(t)),t.on_column_config_click=t.on_column_config_click.bind(jr(t)),t.on_select_checkbox_checked=t.on_select_checkbox_checked.bind(jr(t)),t.on_reload=t.on_reload.bind(jr(t)),t.saveAjaxQueue=t.saveAjaxQueue.bind(jr(t)),t.saveEditableField=t.saveEditableField.bind(jr(t)),t.setColumnsOrder=t.setColumnsOrder.bind(jr(t)),t.showMore=t.showMore.bind(jr(t)),t.sortBy=t.sortBy.bind(jr(t)),t.toggleCategory=t.toggleCategory.bind(jr(t)),t.toggleColumn=t.toggleColumn.bind(jr(t)),t.toggleRemarks=t.toggleRemarks.bind(jr(t)),t.toggleRow=t.toggleRow.bind(jr(t)),t.updateEditableField=t.updateEditableField.bind(jr(t)),t.root_el=t.props.root_el,t.api_url=t.root_el.dataset.api_url,t.columns=JSON.parse(t.root_el.dataset.columns),t.form_id=t.root_el.dataset.form_id,t.listing_identifier=t.root_el.dataset.listing_identifier,t.pagesize=parseInt(t.root_el.dataset.pagesize),t.review_states=JSON.parse(t.root_el.dataset.review_states),t.show_column_toggles=JSON.parse(t.root_el.dataset.show_column_toggles),t.root_el.addEventListener("reload",t.on_reload),t.api=new g({api_url:t.api_url,on_api_error:t.on_api_error}),t.state={messages:[],loading:!0,show_column_config:!1,filter:t.api.get_url_parameter("".concat(t.form_id,"_filter")),pagesize:parseInt(t.api.get_url_parameter("".concat(t.form_id,"_pagesize")))||t.pagesize,sort_on:t.api.get_url_parameter("".concat(t.form_id,"_sort_on")),sort_order:t.api.get_url_parameter("".concat(t.form_id,"_sort_order")),review_state:t.api.get_url_parameter("".concat(t.form_id,"_review_state"))||"default",query_string:"",api_url:"",form_id:t.form_id,columns:t.get_default_columns(),review_states:t.review_states,folderitems:[],children:{},categories:[],expanded_categories:[],expanded_rows:[],expanded_remarks:[],total:0,selected_uids:[],transitions:[],catalog_indexes:[],catalog_columns:[],sortable_columns:[],ajax_save_queue:{},content_filter:{},allow_edit:!1,show_select_all_checkbox:!1,show_select_column:!1,show_column_toggles:t.show_column_toggles,select_checkbox_name:"uids",post_action:"workflow_action",show_categories:!1,expand_all_categories:!1,show_more:!1,limit_from:0,show_search:!1,show_ajax_save:!1,show_table_footer:!1,fetch_transitions_on_select:!0},t}return t=a,(n=[{key:"dismissMessage",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===t?this.setState({messages:[]}):((e=[].concat(this.state.messages)).splice(t,1),this.setState({messages:e})),!0}},{key:"addMessage",value:function(e,t,n){var r,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info";return"object"===vr(e)&&(e=(o=Object.assign(e)).title,t=o.text,n=o.traceback,i=o.level),(r=[].concat(this.state.messages)).push({title:e,text:t,traceback:n,level:i}),this.setState({messages:r}),!0}},{key:"getRequestOptions",value:function(){var e;return e={review_state:this.state.review_state,filter:this.state.filter,sort_on:this.state.sort_on,sort_order:this.state.sort_order,pagesize:this.state.pagesize,limit_from:this.state.limit_from,selected_uids:this.state.selected_uids},console.debug("Request Options=",e),e}},{key:"componentDidMount",value:function(){return this.fetch_folderitems()}},{key:"componentDidUpdate",value:function(e,t,n){}},{key:"toggleCategory",value:function(e){var t,n;return console.debug("ListingController::toggleCategory: column=".concat(e)),(n=(t=this.state.expanded_categories).indexOf(e))>-1?t.splice(n,1):t.push(e),this.setState({expanded_categories:t}),t.length>0}},{key:"toggleRemarks",value:function(e){var t,n;return console.debug("ListingController::toggleRemarks: uid=".concat(e)),!!e&&((n=(t=this.state.expanded_remarks).indexOf(e))>-1?t.splice(n,1):t.push(e),this.setState({expanded_remarks:t}),t.length>0)}},{key:"toggleRow",value:function(e){var t,n,r;return console.debug("ListingController::toggleRow: uid=".concat(e)),!!e&&((n=(t=this.state.expanded_rows).indexOf(e))>-1?t.splice(n,1):t.push(e),r=this,e in this.state.children?this.setState({expanded_rows:t}):this.fetch_children({parent_uid:e}).then((function(n){var o,i,a,s,c;for(i=r.state.children,s=n.children||[],i[e]=s,a=0,c=s.length;a<c;a++)(o=s[a]).selected&&r.selectUID(o.uid,!0);return r.setState({children:i,expanded_rows:t})})),t.length>0)}},{key:"toggleColumn",value:function(e){var t,n,r,o;if(console.debug("ListingController::toggleColumn: key=".concat(e)),"reset"===e)return this.setState({columns:this.get_default_columns()}),this.set_local_column_config([]),!0;for(e in void 0===(o=(r=this.state.columns)[e].toggle)&&(o=!0),r[e].toggle=!o,n=[],r)t=r[e],n.push({key:e,toggle:t.toggle});return this.set_local_column_config(n),this.setState({columns:r}),o}},{key:"setColumnsOrder",value:function(e){var t,n,r,o,i,a,s,c;for(console.debug("ListingController::setColumnsOrder: order=".concat(e)),s={},n=[],(i=Object.keys(this.state.columns)).sort((function(t,n){return e.indexOf(t)-e.indexOf(n)})),r=0,a=i.length;r<a;r++)o=i[r],void 0===(c=(t=this.state.columns[o]).toggle)&&(c=!0),n.push({key:o,toggle:c}),s[o]=t;return this.set_local_column_config(n),this.setState({columns:s}),s}},{key:"get_visible_columns",value:function(){var e,t,n,r,o,i,a;for(r=[],e=this.get_allowed_column_keys(),a=this.get_columns_visibility(),t=0,o=(i=this.get_columns_order()).length;t<o;t++)n=i[t],Rr.call(e,n)<0||!1!==a[n]&&r.push(n);return r}},{key:"get_default_columns",value:function(){return JSON.parse(this.root_el.dataset.columns)}},{key:"get_columns",value:function(){var e,t,n,r,o,i,a,s;for(t={},s=this.get_columns_visibility(),n=0,o=(i=this.get_columns_order()).length;n<o;n++)r=i[n],void 0!==(e=this.state.columns[r])?(void 0!==(a=s[r])&&(e.toggle=a),t[r]=e):console.warn("Skipping nonexisting column '".concat(r,"'."));return t}},{key:"get_columns_keys",value:function(){return Object.keys(this.state.columns)}},{key:"get_columns_order",value:function(){var e,t,n;return t=this.get_columns_keys(),n=(n=this.get_local_column_config()).filter((function(e){return-1!==t.indexOf(e.key)})),this.state.show_column_toggles&&n.length>0?n.map((function(e,t){return e.key})):(e=this.get_allowed_column_keys()).concat(t.filter((function(t){return-1===e.indexOf(t)})))}},{key:"get_columns_visibility",value:function(){var e,t,n,r,o,i,a;if(a={},r=this.get_local_column_config(),this.state.show_column_toggles&&r.length>0)for(e=0,n=r.length;e<n;e++){var s=r[e];t=s.key,void 0===(i=s.toggle)&&(i=!0),a[t]=i}else for(t in o=this.state.columns)void 0===(i=o[t].toggle)&&(i=!0),a[t]=i;return a}},{key:"filterByState",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return console.debug("ListingController::filterByState: review_state=".concat(e)),this.set_state({review_state:e,pagesize:this.pagesize,limit_from:0}),!0}},{key:"filterBySearchterm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return console.debug("ListingController::filterBySearchter: filter=".concat(e)),this.set_state({filter:e,pagesize:this.pagesize,limit_from:0}),!0}},{key:"sortBy",value:function(e,t){return console.debug("sort_on=".concat(e," sort_order=").concat(t)),this.set_state({sort_on:e,sort_order:t,pagesize:this.get_item_count(),limit_from:0}),!0}},{key:"showMore",value:function(e){var t,n;return console.debug("ListingController::showMore: pagesize=".concat(e)),t=this.state.folderitems,n=this,this.setState({pagesize:parseInt(e),limit_from:this.state.folderitems.length,loading:!0},(function(){return n.api.fetch_folderitems(n.getRequestOptions()).then((function(e){var r;if(n.toggle_loader(!1),e.folderitems.length>0)return console.debug("Adding ".concat(e.folderitems.length," more folderitems...")),r=t.concat(e.folderitems),n.setState({folderitems:r})}))})),!0}},{key:"doAction",value:function(e,t){var n,r,o;if("clear_selection"!==e)return r=document.getElementById(this.state.form_id),n=e.split("_transition")[0],(o=document.createElement("input")).setAttribute("type","hidden"),o.setAttribute("id",e),o.setAttribute("name","workflow_action_id"),o.setAttribute("value",n),r.appendChild(o),t&&(r.action=t),r.submit();this.selectUID("all",!1)}},{key:"selectUID",value:function(e,t){var n,r,o,i,a,s,c,l,u=this;if(l=[].concat(this.state.selected_uids),!0===t)if("all"===e)for(i=0,a=(r=this.state.folderitems.filter((function(e){return!e.disabled})).map((function(e){return e.uid}))).length;i<a;i++)e=r[i],Rr.call(l,e)<0&&l.push(e);else Rr.call(l,e)<0&&l.push(e);else"all"===e?(o=this.group_by_uid(this.state.folderitems),l=l.filter((function(e){return o[e].readonly}))):(s=l.indexOf(e),l.splice(s,1));if(n=l.filter((function(e){return-1===u.state.selected_uids.indexOf(e)})).length>0,c=this.state.selected_uids.filter((function(e){return-1===l.indexOf(e)})).length>0,n||c)return new Promise((function(e,t){return u.setState({selected_uids:l},e)}))}},{key:"saveAjaxQueue",value:function(){return Object.keys(this.state.ajax_save_queue).length>0&&this.ajax_save()}},{key:"saveEditableField",value:function(e,t,n,r){var o,i,a;return!(Rr.call(r.allow_edit,t)<0||(console.debug("ListingController::saveEditableField: uid=".concat(e," name=").concat(t," value=").concat(n)),(i=this.state.columns[t]||{}).ajax&&(a=this,null==(o=this.state.ajax_save_queue)[e]&&(o[e]={}),o[e][t]=n,this.setState({show_ajax_save:!0,ajax_save_queue:o},(function(){if(i.autosave)return a.ajax_save()}))),0))}},{key:"updateEditableField",value:function(e,t,n,r){var o;return console.debug("ListingController::updateEditableField: uid=".concat(e," name=").concat(t," value=").concat(n)),this.saveEditableField(e,t,n,r),o=this,this.is_uid_selected(e)||(o=this,this.selectUID(e,!0).then((function(){if(o.state.fetch_transitions_on_select)return o.fetch_transitions()}))),!0}},{key:"is_uid_selected",value:function(e){return Rr.call(this.state.selected_uids,e)>=0}},{key:"get_review_state_by_id",value:function(e){var t,n,r,o,i;for(t=null,n=0,r=(o=this.state.review_states).length;n<r;n++)if((i=o[n]).id===e){t=i;break}return t||(console.warn("No review_state with ID '".concat(e,"' found")),{id:"default",columns:this.get_columns_keys()})}},{key:"get_allowed_column_keys",value:function(){var e,t,n;return n=this.state.review_state,(t=this.get_review_state_by_id(n).columns)||Object.keys(this.state.columns),e=this.state.columns,t=t.filter((function(t){return void 0!==e[t]}))}},{key:"get_local_storage_key",value:function(e,t){var n;return n=this.listing_identifier,void 0===this.listing_identifier&&(n=location.pathname),void 0!==e&&(n=e+n),void 0!==t&&(n+=t),n}},{key:"set_local_column_config",value:function(e){var t;return console.debug("ListingController::set_local_column_config: columns=",e),t=this.get_local_storage_key("columns-"),window.localStorage.setItem(t,JSON.stringify(e)),!0}},{key:"get_local_column_config",value:function(){var e,t;if(t=this.get_local_storage_key("columns-"),!(e=window.localStorage.getItem(t)))return[];try{return JSON.parse(e)}catch(e){return[]}}},{key:"get_columns_count",value:function(){var e;return e=this.get_visible_columns().length,this.state.show_select_column&&(e+=1),e}},{key:"get_expanded_categories",value:function(){return this.state.expand_all_categories||this.state.filter?[].concat(this.state.categories):[]}},{key:"group_by_uid",value:function(e){var t;return null==e&&(e=this.state.folderitems),t={},e.map((function(e,n){var r;return r=e.uid||e.column_key||n,t[r]=e})),t}},{key:"get_item_count",value:function(){return this.state.folderitems.length}},{key:"toggle_loader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.setState({loading:e}),e}},{key:"set_state",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t=this,this.setState(e,(function(){if(n)return t.fetch_folderitems()})),!0}},{key:"fetch_transitions",value:function(){var e,t;if(0!==this.state.selected_uids.length)return this.toggle_loader(!0),t=this.api.fetch_transitions(this.getRequestOptions()),e=this,t.then((function(t){return e.setState(t,(function(){return console.debug("ListingController::fetch_transitions: NEW STATE=",e.state),e.toggle_loader(!1)}))})),t;this.setState({transitions:[]})}},{key:"fetch_folderitems",value:function(){var e,t;return this.toggle_loader(!0),t=this.api.fetch_folderitems(this.getRequestOptions()),e=this,t.then((function(t){var n,r,o,i,a,s,c,l,u;for(console.debug("ListingController::fetch_folderitems: GOT RESPONSE=",t),r=e.group_by_uid(e.state.folderitems),c=e.group_by_uid(t.folderitems),s=t.categories||[],i=0,a=(l=e.state.selected_uids).length;i<a;i++)if(!((u=l[i])in c)){if(!(o=r[u]))continue;c[u]=r[u],(n=o.category)&&Rr.call(s,n)<0&&(s.push(n),s.sort())}return t.categories=s,t.folderitems=Object.values(c),e.setState(t,(function(){return e.setState({expanded_categories:e.get_expanded_categories()},(function(){return console.debug("ListingController::fetch_folderitems: NEW STATE=",e.state)})),e.toggle_loader(!1)}))})),t}},{key:"fetch_children",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.parent_uid,i=r.child_uids;if(this.toggle_loader(!0),!i){if(!(e=this.group_by_uid()[o]))throw"No folderitem could be found for UID ".concat(uid);i=e.children||[]}return n=this.api.fetch_children({parent_uid:o,child_uids:i}),t=this,n.then((function(e){return console.debug("ListingController::fetch_children: GOT RESPONSE=",e),t.toggle_loader(!1)})),n}},{key:"render_toolbar_top",value:function(){return!!this.state.show_more||!!this.state.show_search||this.state.review_states.length>1}},{key:"ajax_save",value:function(){var e,t;return console.debug("ListingController::ajax_save:ajax_save_queue=",this.state.ajax_save_queue),this.toggle_loader(!0),t=this.api.set_fields({save_queue:this.state.ajax_save_queue}),e=this,t.then((function(t){var n;return console.debug("ListingController::ajax_save: GOT DATA=",t),(t.uids||[]).map((function(t,n){return e.selectUID(t,!0)})),n=t.folderitems||[],e.update_existing_folderitems_with(n),e.state.fetch_transitions_on_select&&e.fetch_transitions(),e.setState({show_ajax_save:!1,ajax_save_queue:{}}),e.toggle_loader(!1)})),t}},{key:"update_existing_folderitems_with",value:function(e){var t,n,r,o,i,a,s,c;for(s in console.log("ListingController::update_existing_folderitems_with: ",e),o=[],c=this.group_by_uid(e),t=this.group_by_uid(this.state.folderitems))if(n=t[s],a=Object.assign({},n),s in c){for(r in i=Object.assign({},c[s]),a)a[r],"rowspan"!==r&&"colspan"!==r&&"skip"!==r||(i[r]=a[r]),i.hasOwnProperty(r)||(i[r]=a[r]);o.push(i)}else o.push(a);return this.setState({folderitems:o})}},{key:"on_column_config_click",value:function(e){var t;if(e.preventDefault(),this.state.show_column_toggles)return t=!this.state.show_column_config,this.setState({show_column_config:t})}},{key:"on_select_checkbox_checked",value:function(e){var t,n,r,o;return console.debug("°°° ListingController::on_select_checkbox_checked"),r=this,o=(n=e.currentTarget).value,t=n.checked,this.selectUID(o,t).then((function(){if(r.state.fetch_transitions_on_select)return r.fetch_transitions()}))}},{key:"on_api_error",value:function(e){var t=this;return this.toggle_loader(!1),console.debug("°°° ListingController::on_api_error: GOT AN ERROR RESPONSE: ",e),e.text().then((function(n){var r,o;return o=_t("Oops, an error occured! 🙈"),r=_t("The server responded with the status ".concat(e.status,": ").concat(e.statusText)),t.addMessage(o,r,null,"danger")})),e}},{key:"on_reload",value:function(e){return console.debug("°°° ListingController::on_reload:event=",e),this.fetch_folderitems()}},{key:"render",value:function(){var e,t,n,r,i,a;return console.debug("*** RENDER ***"),e=this.get_columns(),n=this.get_columns_order(),t=this.get_columns_count(),a=this.get_visible_columns(),r=this.get_item_count(),i=this.render_toolbar_top(),o.a.createElement("div",{className:"listing-container"},o.a.createElement(L,{on_dismiss_message:this.dismissMessage,id:"messages",className:"messages",messages:this.state.messages}),this.state.loading&&o.a.createElement("div",{id:"table-overlay"}),!i&&this.state.loading&&o.a.createElement(E,{loading:this.state.loading}),i&&o.a.createElement("div",{className:"row top-toolbar"},o.a.createElement("div",{className:"col-sm-8"},o.a.createElement(y,{className:"filterbar nav nav-pills",on_filter_button_clicked:this.filterByState,review_state:this.state.review_state,review_states:this.state.review_states})),o.a.createElement("div",{className:"col-sm-1 text-right"},o.a.createElement(E,{loading:this.state.loading})),o.a.createElement("div",{className:"col-sm-3 text-right"},o.a.createElement($,{show_search:this.state.show_search,on_search:this.filterBySearchterm,filter:this.state.filter,placeholder:_t("Search")}))),o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-12 table-responsive"},this.state.show_column_toggles&&o.a.createElement("a",{href:"#",onClick:this.on_column_config_click,className:"pull-right"},o.a.createElement("i",{className:"fas fa-ellipsis-h"})),this.state.show_column_config&&o.a.createElement(gr,{title:_t("Configure Table Columns"),description:_t("Click to toggle the visibility or drag&drop to change the order"),columns:e,columns_order:n,on_column_toggle_click:this.toggleColumn,on_columns_order_change:this.setColumnsOrder}),o.a.createElement(fr,{className:"contentstable table table-condensed table-hover small",allow_edit:this.state.allow_edit,on_header_column_click:this.sortBy,on_select_checkbox_checked:this.on_select_checkbox_checked,on_context_menu:this.on_column_config_click,sort_on:this.state.sort_on,sort_order:this.state.sort_order,catalog_indexes:this.state.catalog_indexes,catalog_columns:this.state.catalog_columns,sortable_columns:this.state.sortable_columns,columns:e,columns_count:t,review_state:this.state.review_state,visible_columns:a,review_states:this.state.review_states,folderitems:this.state.folderitems,children:this.state.children,selected_uids:this.state.selected_uids,select_checkbox_name:this.state.select_checkbox_name,show_select_column:this.state.show_select_column,show_select_all_checkbox:this.state.show_select_all_checkbox,categories:this.state.categories,expanded_categories:this.state.expanded_categories,expanded_rows:this.state.expanded_rows,expanded_remarks:this.state.expanded_remarks,show_categories:this.state.show_categories,on_category_click:this.toggleCategory,on_row_expand_click:this.toggleRow,on_remarks_expand_click:this.toggleRemarks,filter:this.state.filter,update_editable_field:this.updateEditableField,save_editable_field:this.saveEditableField}))),this.state.show_table_footer&&o.a.createElement("div",{className:"row"},o.a.createElement("div",{className:"col-sm-8"},o.a.createElement(s.a,{className:"buttonbar nav nav-pills",show_ajax_save:this.state.show_ajax_save,ajax_save_button_title:_t("Save"),on_transition_button_click:this.doAction,on_ajax_save_button_click:this.saveAjaxQueue,selected_uids:this.state.selected_uids,show_select_column:this.state.show_select_column,transitions:this.state.transitions,review_state:this.get_review_state_by_id(this.state.review_state)})),o.a.createElement("div",{className:"col-sm-1 text-right"},o.a.createElement(E,{loading:this.state.loading})),o.a.createElement("div",{className:"col-sm-3 text-right"},o.a.createElement(U,{id:"pagination",className:"pagination-controls",total:this.state.total,show_more_button_title:_t("Show more"),onShowMore:this.showMore,show_more:this.state.show_more,count:r,pagesize:this.state.pagesize}))))}}])&&kr(t.prototype,n),r&&kr(t,r),a}(o.a.Component)}]);