(()=>{"use strict";var e={311:e=>{e.exports=jQuery}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{const e=React;var t=r.n(e);const n=ReactDOM;var o=r.n(n);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},s.apply(this,arguments)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},l(e,t)}function u(e,t){if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}const p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t)}(h,e);var r,n,o,i,p=(o=h,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=f(o);if(i){var r=f(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return u(this,e)});function h(){return a(this,h),p.apply(this,arguments)}return r=h,(n=[{key:"render",value:function(){return t().createElement("button",s({id:this.props.id,title:this.props.help||this.props.title,name:this.props.name,url:this.props.url,onClick:this.props.onClick,className:this.props.className},this.props.attrs),t().createElement("span",{dangerouslySetInnerHTML:{__html:this.props.title}}),this.props.badge&&t().createElement("span",{className:"badge badge-light",style:{marginLeft:"0.25em"}},this.props.badge))}}])&&c(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),h}(t().Component);var h=r(311);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t){return m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},m(e,t)}function b(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},g(e)}var w=[].indexOf;const k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=g(o);if(i){var r=g(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return b(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_ajax_save_button_click=t.on_ajax_save_button_click.bind(v(t)),t.on_transition_button_click=t.on_transition_button_click.bind(v(t)),t.confirm_transitions=["cancel","deactivate","invalidate","reject","remove","retract","unassign","retest"],t.css_mapping={reassign:"btn-secondary",duplicate:"btn-secondary",close:"btn-secondary",assign:"btn-secondary",receive:"btn-primary",open:"btn-primary",verify:"btn-primary",retest:"btn-primary",activate:"btn-success",prepublish:"btn-success",publish:"btn-success",republish:"btn-success",submit:"btn-success",unassign:"btn-warning",cancel:"btn-danger",deactivate:"btn-danger",invalidate:"btn-danger",reject:"btn-danger",retract:"btn-danger",remove:"btn-danger"},t}return r=a,n=[{key:"componentDidUpdate",value:function(){return h("[data-toggle=confirmation]").confirmation({rootSelector:"[data-toggle=confirmation]",btnOkLabel:_t("Yes"),btnOkClass:"btn btn-outline-primary",btnOkIconClass:"fas fa-check-circle mr-1",btnCancelLabel:_t("No"),btnCancelClass:"btn btn-outline-secondary",btnCancelIconClass:"fas fa-circle mr-1",container:"body",singleton:!0})}},{key:"get_button_css",value:function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r="btn btn-sm mr-1 mb-1",t=this.css_mapping[e],n=o.css_class,r+(t?" ".concat(t):null!=n?" ".concat(n):" btn-outline-secondary")}},{key:"on_ajax_save_button_click",value:function(e){if(e.preventDefault(),this.props.on_ajax_save_button_click)return this.props.on_ajax_save_button_click()}},{key:"on_transition_button_click",value:function(e){var t,r,n;if(e.preventDefault(),t=(r=e.currentTarget).getAttribute("id"),n=r.getAttribute("url"),this.props.on_transition_button_click)return this.props.on_transition_button_click(t,n)}},{key:"build_buttons",value:function(){var e,r,n,o,i,s,a,c,l,u,f,h,_;for(n=[],this.props.show_select_column&&this.props.transitions.length>0&&n.push(t().createElement("button",{key:"clear",className:"btn btn-outline-secondary btn-sm mb-1 mr-1",title:_t("Clear selection"),onClick:this.on_transition_button_click,id:"clear_selection"},t().createElement("i",{className:"fas fa-circle-notch"}))),this.props.show_ajax_save&&n.push(t().createElement("button",{key:"ajax-save",className:"btn btn-primary btn-sm mb-1 mr-1",onClick:this.on_ajax_save_button_click,title:this.props.ajax_save_button_title,id:"ajax_save_selection"},this.props.ajax_save_button_title," ",t().createElement("i",{className:"fas fa-save"}))),s=0,c=(l=this.props.transitions).length;s<c;s++)a=(h=l[s]).id,_=h.url,f=_t(h.title),i=_t(h.help),o=this.get_button_css(a,h),r="".concat(a,"_transition"),h.css_class&&(o+=" ".concat(h.css_class)),u=this.props.review_state.confirm_transitions||[],e=h.attrs||{},(w.call(this.confirm_transitions,a)>=0||w.call(u,a)>=0)&&(e["data-toggle"]="confirmation",e["data-title"]="".concat(f,"?")),n.push(t().createElement(p,{key:h.id,id:r,title:f,help:i,url:_,className:o,badge:this.props.selected_uids.length,onClick:this.on_transition_button_click,attrs:e}));return n}},{key:"render",value:function(){return 0===this.props.selected_uids.length?null:t().createElement("div",{className:"".concat(this.props.className)},this.build_buttons())}}],n&&y(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function O(e){return O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O(e)}function j(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function E(e,t){return E=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},E(e,t)}function x(e,t){if(t&&("object"===O(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return S(e)}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function P(e){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},P(e)}const R=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&E(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=P(o);if(i){var r=P(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return x(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_filter_button_clicked=t.on_filter_button_clicked.bind(S(t)),t}return r=a,(n=[{key:"on_filter_button_clicked",value:function(e){var t;return e.preventDefault(),t=e.currentTarget.id,this.props.on_filter_button_clicked(t)}},{key:"build_filter_buttons",value:function(){var e,r,n,o,i,s;for(o in r=[],e=this.props.review_state,i=this.props.review_states)n="nav-item btn btn-sm btn-outline-secondary mr-1 mb-1",(s=i[o]).id===e&&(n+=" active"),r.push(t().createElement(p,{key:s.id,onClick:this.on_filter_button_clicked,id:s.id,title:s.title,className:n}));return 1===r.length?[]:r}},{key:"render",value:function(){return t().createElement("div",{className:this.props.className},this.build_filter_buttons())}}])&&j(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function N(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}const T=function(){function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api_url=t.api_url,this.form_id=t.form_id||"list",this.on_api_error=t.on_api_error||function(e){},this}var t,r;return t=e,(r=[{key:"get_api_url",value:function(e){return"".concat(this.api_url,"/").concat(e).concat(location.search)}},{key:"to_form_name",value:function(e){return e.startsWith(this.form_id)?e:"".concat(this.form_id,"_").concat(e)}},{key:"get_url_parameter",value:function(e){var t,r;return e=(e=this.to_form_name(e)).replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"),null===(r=(t=new RegExp("[\\?&]"+e+"=([^&#]*)")).exec(location.search)||t.exec(location.hash))?"":decodeURIComponent(r[1].replace(/\+/g," "))}},{key:"parse_hash",value:function(e){var t;return-1===(t=e.indexOf("#"))?[]:e.substring(t).replace("#","").replace("?","").split("&")}},{key:"get_json",value:function(e,t){var r,n,o,i,s,a;return null==t&&(t={}),o=t.method||"POST",r=JSON.stringify(t.data)||"{}",i=this.on_api_error,a=this.get_api_url(e),n={method:o,headers:{"Content-Type":"application/json","X-CSRF-TOKEN":this.get_csrf_token()},body:"POST"===o?r:null,credentials:"include"},s=new Request(a,n),fetch(s).then((function(e){return e.ok?e:Promise.reject(e)})).then((function(e){return e.json()})).catch((function(e){return i(e),e}))}},{key:"set_fields",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("set_fields",t)}},{key:"on_change",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("on_change",t)}},{key:"query_folderitems",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("query_folderitems",t)}},{key:"fetch_children",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("get_children",t)}},{key:"fetch_folderitems",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("folderitems",t)}},{key:"fetch_transitions",value:function(e){var t;return t={data:e||{},method:"POST"},this.get_json("transitions",t)}},{key:"get_csrf_token",value:function(){return document.querySelector("#protect-script").dataset.token}}])&&N(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function C(e){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C(e)}function I(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function B(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function A(e,t){return A=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},A(e,t)}function D(e,t){if(t&&("object"===C(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function q(e){return q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},q(e)}const z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&A(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=q(o);if(i){var r=q(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return D(this,e)});function a(){return I(this,a),s.apply(this,arguments)}return r=a,(n=[{key:"render",value:function(){return this.props.loading?t().createElement("div",{className:"loader"},t().createElement("span",{className:"dot dot_1"}),t().createElement("span",{className:"dot dot_2"}),t().createElement("span",{className:"dot dot_3"}),t().createElement("span",{className:"dot dot_4"})):t().createElement("div",{className:"loader"})}}])&&B(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function M(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function V(e,t){return V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},V(e,t)}function H(e,t){if(t&&("object"===L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return U(e)}function U(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}const J=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=F(o);if(i){var r=F(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return H(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_dismiss_message=t.on_dismiss_message.bind(U(t)),t}return r=a,(n=[{key:"on_dismiss_message",value:function(e){var t;if(e.preventDefault(),t=e.currentTarget.getAttribute("index"),this.props.on_dismiss_message)return this.props.on_dismiss_message(parseInt(t))}},{key:"render_messages",value:function(){var e,r;return r=[],e=this,this.props.messages.map((function(n,o){return r.push(t().createElement("div",{key:o,className:"alert alert-".concat(n.level||"info")},t().createElement("button",{onClick:e.on_dismiss_message,index:o,type:"button",className:"close","aria-label":"Close"},t().createElement("span",{"aria-hidden":"true"},"×")),n.title&&t().createElement("h4",{className:"alert-heading"},n.title),n.text&&t().createElement("div",null,n.text),n.traceback&&t().createElement("pre",null,n.traceback)))})),r}},{key:"render",value:function(){return this.props.messages?t().createElement("div",{id:this.props.id,className:this.props.className},this.render_messages()):null}}])&&M(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function Z(e){return Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z(e)}function W(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $(e,t){return $=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},$(e,t)}function Q(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function K(e){return K=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},K(e)}const Y=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&$(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=K(o);if(i){var r=K(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Q(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,e)}return r=a,(n=[{key:"render",value:function(){return t().createElement("div",{id:"".concat(this.props.id),className:"".concat(this.props.className),tabindex:"-1"})}}])&&W(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ee(e,t){return ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ee(e,t)}function te(e,t){if(t&&("object"===X(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return re(e)}function re(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ne(e){return ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ne(e)}const oe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ee(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ne(o);if(i){var r=ne(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return te(this,e)});function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=s.call(this,e)).state={pagesize:r.props.pagesize},r.on_show_more_click=r.on_show_more_click.bind(re(r)),r.on_pagesize_change=r.on_pagesize_change.bind(re(r)),r.on_export_click=r.on_export_click.bind(re(r)),r.pagesize_input=t().createRef(),r.show_more_button=t().createRef(),r.export_button=t().createRef(),r}return r=a,(n=[{key:"on_show_more_click",value:function(e){var t;return e.preventDefault(),(!(t=parseInt(this.pagesize_input.current.value))||t<1)&&(t=1),this.props.onShowMore(t)}},{key:"on_pagesize_change",value:function(e){var t;if(t=this.get_pagesize_input_value(),this.setState({pagesize:t}),13===e.which)return e.preventDefault(),this.props.onShowMore(t)}},{key:"get_pagesize_input_value",value:function(){var e;return(!(e=parseInt(this.pagesize_input.current.value))||e<1)&&(e=1,this.pagesize_input.current.value=e),e}},{key:"on_export_click",value:function(e){return e.preventDefault(),this.props.onExport()}},{key:"render",value:function(){return this.props.count>=this.props.total?t().createElement("div",{id:this.props.id,className:this.props.className},!this.props.show_export&&t().createElement("div",{className:"text-right"},this.props.count," / ",this.props.total),this.props.show_export&&t().createElement("div",{className:"input-group input-group-sm float-right"},t().createElement("div",{className:"input-group-prepend"},t().createElement("span",{className:"input-group-text"},this.props.count," / ",this.props.total)),t().createElement("span",{className:"input-group-append"},t().createElement("button",{className:"btn btn-outline-secondary",ref:this.export_button,disabled:0===this.props.count,onClick:this.on_export_click},t().createElement("span",null,this.props.export_button_title||"Export"))))):t().createElement("div",{id:this.props.id,className:this.props.className},t().createElement("div",{className:"input-group input-group-sm float-right"},t().createElement("div",{className:"input-group-prepend"},t().createElement("span",{className:"input-group-text"},this.props.count," / ",this.props.total)),t().createElement("input",{type:"text",size:"3",defaultValue:this.state.pagesize,onChange:this.on_pagesize_change,onKeyPress:this.on_pagesize_change,ref:this.pagesize_input,disabled:this.props.count>=this.props.total,className:"form-control"}),t().createElement("span",{className:"input-group-append"},t().createElement("button",{className:"btn btn-outline-secondary",disabled:this.props.count>=this.props.total,ref:this.show_more_button,onClick:this.on_show_more_click},t().createElement("span",null,this.props.show_more_button_title||"Show more")),this.props.show_export&&t().createElement("button",{className:"btn btn-outline-secondary",ref:this.export_button,disabled:0===this.props.count,onClick:this.on_export_click},t().createElement("span",null,this.props.export_button_title||"Export")))))}}])&&G(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function se(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ae(e,t){return ae=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ae(e,t)}function ce(e,t){if(t&&("object"===ie(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return le(e)}function le(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ue(e){return ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ue(e)}const fe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ae(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ue(o);if(i){var r=ue(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return ce(this,e)});function a(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=s.call(this,e)).on_search_field_keypress=r.on_search_field_keypress.bind(le(r)),r.on_search_button_click=r.on_search_button_click.bind(le(r)),r.on_clear_button_click=r.on_clear_button_click.bind(le(r)),r.search_input_field=t().createRef(),r}return r=a,(n=[{key:"on_search_field_keypress",value:function(e){var t;if(13===e.which)return e.preventDefault(),t=this.get_search_value(),this.props.on_search(t)}},{key:"on_search_button_click",value:function(e){var t;return e.preventDefault(),t=this.get_search_value(),this.props.on_search(t)}},{key:"on_clear_button_click",value:function(e){return e.preventDefault(),this.search_input_field.current.value="",this.props.on_search("")}},{key:"get_search_value",value:function(){return this.search_input_field.current.value}},{key:"render",value:function(){return!1===this.props.show_search?null:t().createElement("div",{className:"input-group input-group-sm"},t().createElement("input",{type:"text",autofocus:"true",className:"form-control",ref:this.search_input_field,defaultValue:this.props.filter,onKeyPress:this.on_search_field_keypress,placeholder:this.props.placeholder}),t().createElement("span",{className:"input-group-append"},t().createElement("button",{className:"btn btn-outline-secondary",onClick:this.on_clear_button_click},t().createElement("i",{className:"fas fa-undo"})),t().createElement("button",{className:"btn btn-outline-secondary",onClick:this.on_search_button_click},t().createElement("i",{className:"fas fa-search"}))))}}])&&se(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function he(){return he=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},he.apply(this,arguments)}function _e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function de(e,t){return de=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},de(e,t)}function ye(e,t){if(t&&("object"===pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return me(e)}function me(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function be(e){return be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},be(e)}const ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&de(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=be(o);if(i){var r=be(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return ye(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_change=t.on_change.bind(me(t)),t}return r=a,(n=[{key:"on_change",value:function(e){var t,r,n,o;if(o=(r=e.currentTarget).getAttribute("uid"),n=r.getAttribute("column_key")||r.name,t=r.checked,this.props.update_editable_field&&this.props.update_editable_field(o,n,t,this.props.item),this.props.save_editable_field)return this.props.save_editable_field(o,n,t,this.props.item)}},{key:"render",value:function(){return t().createElement("span",{className:"form-group"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("input",he({key:this.props.name,type:"checkbox",uid:this.props.uid,name:this.props.name,value:this.props.value,column_key:this.props.column_key,title:this.props.title,disabled:this.props.disabled,checked:this.props.checked,defaultChecked:this.props.defaultChecked,className:this.props.className,onChange:this.props.onChange||this.on_change,tabIndex:this.props.tabIndex},this.props.attrs)),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&_e(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function ge(e){return ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ge(e)}function we(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ke(e,t){return ke=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ke(e,t)}function Oe(e,t){if(t&&("object"===ge(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function je(e){return je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},je(e)}const Ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ke(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=je(o);if(i){var r=je(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Oe(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,e)}return r=a,(n=[{key:"render",value:function(){return t().createElement("th",{title:this.props.alt,index:this.props.index,sort_order:this.props.sort_order,className:this.props.className,onClick:this.props.onClick},t().createElement("span",null,this.props.title))}}])&&we(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}function Se(){return Se=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Se.apply(this,arguments)}function Pe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Re(e,t){return Re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Re(e,t)}function Ne(e,t){if(t&&("object"===xe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Te(e)}function Te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ce(e){return Ce=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ce(e)}var Ie=[].indexOf;const Be=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Re(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ce(o);if(i){var r=Ce(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Ne(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_header_column_click=t.on_header_column_click.bind(Te(t)),t}return r=a,(n=[{key:"on_header_column_click",value:function(e){var t,r,n;if(r=(t=e.currentTarget).getAttribute("index"),n=t.getAttribute("sort_order"),r)return Ie.call(t.classList,"active")>=0&&(n="ascending"===n?"descending":"ascending"),this.props.on_header_column_click(r,n)}},{key:"is_required_column",value:function(e){var t,r;return 0!==(t=this.props.folderitems||[]).length&&(r=t[0].required||[],Ie.call(r,e)>=0)}},{key:"is_sortable",value:function(e,t){return!1!==e.sortable&&(!!e.index||Ie.call(this.props.sortable_columns,t)>=0)}},{key:"all_selected",value:function(){var e,t,r,n,o;for(e=0,r=(n=this.props.folderitems).length;e<r;e++)if(!(t=n[e]).disabled&&(o=t.uid,Ie.call(this.props.selected_uids,o)<0))return!1;return!0}},{key:"build_cells",value:function(){var e,r,n,o,i,s,a,c,l,u,f,p,h,_,d,y,m;for(n=[],this.props.item,this.props.show_select_column&&(e=this.all_selected(),h=this.props.show_select_all_checkbox,n.push(t().createElement("th",{className:"select-column",key:"select_all"},h&&t().createElement(ve,{name:"select_all",value:"all",checked:e,onChange:this.props.on_select_checkbox_checked})))),s=0,u=(f=this.props.visible_columns).length;s<u;s++)l=f[s],i=this.props.columns[l],y=this.is_sortable(i,l),a=i.index||l,m=i.title,r=i.alt||m,_=this.props.sort_on||"created",d=this.props.sort_order||"ascending",c=a===_,p=this.is_required_column(l),o=[l],y&&o.push("sortable"),c&&y&&o.push("active ".concat(d)),p&&o.push("required"),o=o.join(" "),n.push(t().createElement(Ee,Se({key:l},this.props,{title:m,alt:r,index:a,sort_order:d,className:o,onClick:y?this.on_header_column_click:void 0})));return n}},{key:"render",value:function(){return t().createElement("tr",{onContextMenu:this.props.on_context_menu},this.build_cells())}}])&&Pe(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function Ae(e){return Ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ae(e)}function De(){return De=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},De.apply(this,arguments)}function qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ze(e,t){return ze=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ze(e,t)}function Le(e,t){if(t&&("object"===Ae(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Me(e){return Me=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Me(e)}const Ve=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ze(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Me(o);if(i){var r=Me(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Le(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,e)}return r=a,(n=[{key:"render",value:function(){return t().createElement("span",{className:"form-group"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("input",De({type:"hidden",uid:this.props.uid,name:this.props.name,value:this.props.value,column_key:this.props.column_key,className:this.props.className},this.props.attrs)),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&qe(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(e)}function Ue(){return Ue=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ue.apply(this,arguments)}function Fe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Je(e,t){return Je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Je(e,t)}function Ze(e,t){if(t&&("object"===He(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return We(e)}function We(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function $e(e){return $e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},$e(e)}const Qe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Je(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$e(o);if(i){var r=$e(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Ze(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_change=t.on_change.bind(We(t)),t}return r=a,(n=[{key:"on_change",value:function(e){var t,r,n,o,i,s,a;if(s=(r=e.currentTarget).parentNode.parentNode,t=s.querySelectorAll("input[type='checkbox']:checked"),i=r.getAttribute("uid"),o=r.getAttribute("column_key")||r.name,a=function(){var e,r,o;for(o=[],e=0,r=t.length;e<r;e++)n=t[e],o.push(n.value);return o}(),this.props.update_editable_field)return this.props.update_editable_field(i,o,a,this.props.item)}},{key:"build_options",value:function(){var e,r,n,o,i,s,a,c;for(o=[],e=0,r=(s=this.props.options.sort((function(e,t){var r,n;return(r=e.ResultText.toLowerCase())>(n=t.ResultText.toLowerCase())?1:r<n?-1:0}))).length;e<r;e++)c=(n=s[e]).ResultValue,a=n.ResultText,i=n.selected||!1,o.push(t().createElement("li",{key:c},t().createElement("input",Ue({type:"checkbox",defaultChecked:i,uid:this.props.uid,name:this.props.name,value:c,onChange:this.props.onChange||this.on_change,column_key:this.props.column_key,tabIndex:this.props.tabIndex},this.props.attrs))," ",a));return o}},{key:"render",value:function(){return t().createElement("div",{className:"multichoice"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("ul",{className:"list-unstyled"},this.build_options()),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&Fe(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function Ke(e){return Ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ke(e)}function Ye(){return Ye=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ye.apply(this,arguments)}function Xe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ge(e,t){return Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ge(e,t)}function et(e,t){if(t&&("object"===Ke(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return tt(e)}function tt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function rt(e){return rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},rt(e)}var nt=[].indexOf;const ot=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ge(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=rt(o);if(i){var r=rt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return et(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).state={value:e.defaultValue},t.on_change=t.on_change.bind(tt(t)),t}return r=a,(n=[{key:"on_change",value:function(e){var t,r,n,o,i,s,a;if(s=(r=e.currentTarget).parentNode.parentNode,t=s.querySelectorAll("select"),i=r.getAttribute("uid"),o=r.getAttribute("column_key")||r.name,a=function(){var e,r,o;for(o=[],e=0,r=t.length;e<r;e++)n=t[e],o.push(n.value);return o}(),this.setState({value:a}),this.props.update_editable_field)return this.props.update_editable_field(i,o,a,this.props.item)}},{key:"build_options",value:function(e){var r,n,o,i,s,a,c,l,u;for(s=[],a=(a=this.props.options||[]).filter((function(t){var r;return r=t.ResultValue,nt.call(e,r)<0})),r=a.filter((function(e){return""===e.ResultValue})),0===r.length&&a.push({ResultValue:"",ResultText:""}),n=0,o=(c=a.sort((function(e,t){var r,n;return(r=e.ResultText.toLowerCase())>(n=t.ResultText.toLowerCase())?1:r<n?-1:0}))).length;n<o;n++)u=(i=c[n]).ResultValue,l=i.ResultText,s.push(t().createElement("option",{value:u},l));return s}},{key:"to_array",value:function(e){return e?Array.isArray(e)?e:JSON.parse(e):[]}},{key:"build_selectors",value:function(){var e,r,n,o,i,s,a,c;for(c=(c=this.to_array(this.state.value)).filter((function(e){return""!==e})),r=[],this.props.duplicates?c.push(""):(r=c,i=this.props.options||[],c.length<i.length&&c.push("")),a=[],n=0,o=c.length;n<o;n++)s=c[n],e=r.filter((function(e){return e!==s})),a.push(t().createElement("li",{key:s},t().createElement("select",Ye({value:s,uid:this.props.uid,name:this.props.name,onChange:this.props.onChange||this.on_change,column_key:this.props.column_key,className:this.props.className},this.props.attrs),this.build_options(e))));return a}},{key:"render",value:function(){return t().createElement("div",{className:"multiselect"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("ul",{className:"list-unstyled",tabIndex:this.props.tabIndex},this.build_selectors()),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&Xe(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function it(e){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},it(e)}function st(){return st=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},st.apply(this,arguments)}function at(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ct(e,t){return ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},ct(e,t)}function lt(e,t){if(t&&("object"===it(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ut(e)}function ut(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ft(e){return ft=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},ft(e)}const pt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ct(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=ft(o);if(i){var r=ft(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return lt(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).state={value:e.defaultValue},t.on_change=t.on_change.bind(ut(t)),t}return r=a,(n=[{key:"on_change",value:function(e){var t,r,n,o,i,s,a;if(s=(t=e.currentTarget).parentNode.parentNode,n=s.querySelectorAll("input"),i=t.getAttribute("uid"),o=t.getAttribute("column_key")||t.name,a=(a=function(){var e,t,o;for(o=[],e=0,t=n.length;e<t;e++)r=n[e],o.push(r.value.trim());return o}()).filter((function(e){return""!==e})),this.setState({value:a}),this.props.update_editable_field)return this.props.update_editable_field(i,o,a,this.props.item)}},{key:"to_array",value:function(e){return e?Array.isArray(e)?e:JSON.parse(e):[]}},{key:"build_inputs",value:function(){var e,r,n,o,i;for(i=(i=this.to_array(this.state.value)).filter((function(e){return""!==e})),i.push(""),r=[],e=0,n=i.length;e<n;e++)o=i[e],r.push(t().createElement("li",null,t().createElement("input",st({type:"text",size:this.props.size||5,value:o,uid:this.props.uid,name:this.props.name,onChange:this.props.onChange||this.on_change,column_key:this.props.column_key,className:this.props.className},this.props.attrs))));return r}},{key:"render",value:function(){return t().createElement("div",{className:"multivalue"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("ul",{className:"list-unstyled",tabIndex:this.props.tabIndex},this.build_inputs()),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&at(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function ht(e){return ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ht(e)}function dt(){return dt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dt.apply(this,arguments)}function yt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function mt(e,t){return mt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},mt(e,t)}function bt(e,t){if(t&&("object"===ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return vt(e)}function vt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function gt(e){return gt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},gt(e)}const wt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mt(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=gt(o);if(i){var r=gt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return bt(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).state={value:e.defaultValue},t.on_blur=t.on_blur.bind(vt(t)),t.on_change=t.on_change.bind(vt(t)),t}return r=a,(n=[{key:"componentDidUpdate",value:function(e){if(this.props.defaultValue!==e.defaultValue)return this.setState({value:this.props.defaultValue})}},{key:"on_blur",value:function(e){var t,r,n,o;if(n=(t=e.currentTarget).getAttribute("uid"),r=t.getAttribute("column_key")||t.name,o=(o=t.value).replace(/\.*$/,""),t.value=o,this.props.save_editable_field)return this.props.save_editable_field(n,r,o,this.props.item)}},{key:"on_change",value:function(e){var t,r,n,o;if(n=(t=e.currentTarget).getAttribute("uid"),r=t.getAttribute("column_key")||t.name,o=t.value,o=this.to_float(o),t.value=o,this.setState({value:o}),this.props.update_editable_field)return this.props.update_editable_field(n,r,o,this.props.item)}},{key:"to_float",value:function(e){return(e=e.replace(/(^[-,<,>]?)(\d*)([\.,]?\d*)(.*)/,"$1$2$3")).replace(",",".")}},{key:"render",value:function(){return t().createElement("span",{className:"form-group"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("input",dt({type:"text",size:this.props.size||5,uid:this.props.uid,name:this.props.name,value:this.state.value,column_key:this.props.column_key,title:this.props.title,disabled:this.props.disabled,required:this.props.required,className:this.props.className,placeholder:this.props.placeholder,onBlur:this.props.onBlur||this.on_blur,onChange:this.props.onChange||this.on_change,tabIndex:this.props.tabIndex},this.props.attrs)),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&yt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function kt(e){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kt(e)}function Ot(){return Ot=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ot.apply(this,arguments)}function jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Et(e,t){return Et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Et(e,t)}function xt(e,t){if(t&&("object"===kt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function St(e){return St=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},St(e)}const Pt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Et(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=St(o);if(i){var r=St(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return xt(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,e)}return r=a,(n=[{key:"render",value:function(){return t().createElement("span",{className:"form-group"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("input",Ot({type:"text",size:this.props.size||5,uid:this.props.uid,name:this.props.name,value:this.props.value||"",column_key:this.props.column_key,title:this.props.title,disabled:!0,required:this.props.required,className:this.props.className,placeholder:this.props.placeholder,tabIndex:"-1"},this.props.attrs)),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&jt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function Rt(e){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rt(e)}function Nt(){return Nt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Nt.apply(this,arguments)}function Tt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ct(e,t){return Ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Ct(e,t)}function It(e,t){if(t&&("object"===Rt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Bt(e){return Bt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Bt(e)}const At=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ct(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Bt(o);if(i){var r=Bt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return It(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,e)}return r=a,(n=[{key:"is_boolean_field",value:function(){return"boolean"==typeof this.props.value}},{key:"render",value:function(){return this.is_boolean_field()?this.props.value?t().createElement("span",null,_t("Yes")):t().createElement("span",null,_t("No")):t().createElement("span",{className:this.props.className},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("span",Nt({dangerouslySetInnerHTML:{__html:this.props.formatted_value}},this.props.attrs)),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&Tt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function Dt(e){return Dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dt(e)}function qt(){return qt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qt.apply(this,arguments)}function zt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Lt(e,t){return Lt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Lt(e,t)}function Mt(e,t){if(t&&("object"===Dt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Vt(e)}function Vt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ht(e){return Ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Ht(e)}const Ut=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Lt(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Ht(o);if(i){var r=Ht(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Mt(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).state={value:e.defaultValue||""},t.on_blur=t.on_blur.bind(Vt(t)),t.on_change=t.on_change.bind(Vt(t)),t}return r=a,(n=[{key:"componentDidUpdate",value:function(e){if(this.props.defaultValue!==e.defaultValue)return this.setState({value:this.props.defaultValue})}},{key:"on_blur",value:function(e){var t,r,n,o;if(n=(t=e.currentTarget).getAttribute("uid"),r=t.getAttribute("column_key")||t.name,o=t.value,this.setState({value:o}),this.props.save_editable_field)return this.props.save_editable_field(n,r,o,this.props.item)}},{key:"on_change",value:function(e){var t,r,n,o;if(n=(t=e.currentTarget).getAttribute("uid"),r=t.getAttribute("column_key")||t.name,(o=t.value)!==this.state.value)return this.setState({value:o}),this.props.update_editable_field?this.props.update_editable_field(n,r,o,this.props.item):void 0}},{key:"build_options",value:function(){var e,r,n,o,i,s,a;for(o=[],e=0,r=(i=this.props.options.sort((function(e,t){var r,n;return(r=e.ResultText)>(n=t.ResultText)?1:r<n?-1:0}))).length;e<r;e++)a=(n=i[e]).ResultValue,s=n.ResultText,o.push(t().createElement("option",{key:a,value:a},s));return o}},{key:"render",value:function(){return t().createElement("span",{className:"form-group"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("select",qt({key:this.props.name,uid:this.props.uid,name:this.props.name,value:this.state.value,column_key:this.props.column_key,title:this.props.title,disabled:this.props.disabled,onBlur:this.props.onBlur||this.on_blur,onChange:this.props.onChange||this.on_change,required:this.props.required,className:this.props.className,tabIndex:this.props.tabIndex},this.props.attrs),this.build_options()),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&zt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function Ft(e){return Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ft(e)}function Jt(){return Jt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Jt.apply(this,arguments)}function Zt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Wt(e,t){return Wt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Wt(e,t)}function $t(e,t){if(t&&("object"===Ft(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Qt(e)}function Qt(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Kt(e){return Kt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Kt(e)}const Yt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wt(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Kt(o);if(i){var r=Kt(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return $t(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).state={value:e.defaultValue},t.on_change=t.on_change.bind(Qt(t)),t}return r=a,(n=[{key:"componentDidUpdate",value:function(e){if(this.props.defaultValue!==e.defaultValue)return this.setState({value:this.props.defaultValue})}},{key:"on_change",value:function(e){var t,r,n,o;if(n=(t=e.currentTarget).getAttribute("uid"),r=t.getAttribute("column_key")||t.name,o=t.value,this.setState({value:o}),this.props.update_editable_field)return this.props.update_editable_field(n,r,o,this.props.item)}},{key:"render",value:function(){return t().createElement("span",{className:"form-group"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("input",Jt({type:"text",size:this.props.size||20,uid:this.props.uid,name:this.props.name,value:this.state.value,column_key:this.props.column_key,title:this.props.title,disabled:this.props.disabled,required:this.props.required,className:this.props.className,placeholder:this.props.placeholder,onChange:this.props.onChange||this.on_change,tabIndex:this.props.tabIndex},this.props.attrs)),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&Zt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function Xt(e){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xt(e)}function Gt(){return Gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Gt.apply(this,arguments)}function er(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function tr(e,t){return tr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},tr(e,t)}function rr(e,t){if(t&&("object"===Xt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return nr(e)}function nr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function or(e){return or=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},or(e)}const ir=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tr(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=or(o);if(i){var r=or(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return rr(this,e)});function a(e){var r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=s.call(this,e)).state={value:e.defaultValue,date_value:"",time_value:""},e.defaultValue&&(n=e.defaultValue.split(" "),r.state.date_value=n.length>0?n[0]:"",r.state.time_value=n.length>1?n[1]:""),r.dt_date=t().createRef(),r.dt_time=t().createRef(),r.dt_hidden=t().createRef(),r.on_change=r.on_change.bind(nr(r)),r}return r=a,(n=[{key:"componentDidUpdate",value:function(e){if(this.props.defaultValue!==e.defaultValue)return this.setState({value:this.props.defaultValue})}},{key:"on_change",value:function(e){var t,r,n,o,i,s;if(t=this.dt_date.current.value,r=this.dt_time.current.value,t&&!r&&(r="00:00"),s=t&&r?"".concat(t," ").concat(r):"",this.setState({value:s,date_value:t,time_value:r}),i=(n=this.dt_hidden.current).getAttribute("uid"),o=n.getAttribute("column_key")||n.name,s=n.value,this.props.update_editable_field)return this.props.update_editable_field(i,o,s,this.props.item)}},{key:"render",value:function(){return t().createElement("span",{className:"form-group"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("div",{className:"input-group flex-nowrap d-inline-flex w-auto datetimewidget"},t().createElement("input",Gt({type:"date",ref:this.dt_date,name:"".concat(this.props.name,"-date"),title:this.props.title,className:this.props.className,disabled:this.props.disabled,required:this.props.required,onChange:this.props.onChange||this.on_change,tabIndex:this.props.tabIndex,value:this.state.date_value,min:this.props.min_date,max:this.props.max_date},this.props.attrs)),t().createElement("input",Gt({type:"time",ref:this.dt_time,name:"".concat(this.props.name,"-time"),className:this.props.className,title:this.props.title,disabled:this.props.disabled,required:this.props.required,onChange:this.props.onChange||this.on_change,tabIndex:this.props.tabIndex,value:this.state.time_value,min:this.props.min_time,max:this.props.max_time},this.props.attrs))),t().createElement("input",{type:"hidden",ref:this.dt_hidden,uid:this.props.uid,name:this.props.name,column_key:this.props.column_key,value:this.state.value}),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}}))}}])&&er(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function sr(e){return sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sr(e)}function ar(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw o}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return cr(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?cr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function cr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function lr(){return lr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lr.apply(this,arguments)}function ur(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fr(e,t){return fr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},fr(e,t)}function pr(e,t){if(t&&("object"===sr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function hr(e){return hr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},hr(e)}var _r=[].indexOf;const dr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fr(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=hr(o);if(i){var r=hr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return pr(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).ZPUBLISHER_CONVERTER={boolean:":record:ignore_empty",select:":records",choices:":records",multiselect:":list",multichoice:":list",multivalue:":list",numeric:":records",string:":records",datetime:":records",readonly:"",default:":records"},t}return r=a,n=[{key:"get_column",value:function(){return this.props.column}},{key:"get_item",value:function(){return this.props.item}},{key:"get_column_key",value:function(){return this.props.column_key}},{key:"render_before_content",value:function(){var e,r,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n=this.get_column_key(),o=this.get_item())return n in(e=o.before)?(r=o.before_components||{},t().createElement("span",{key:n+"_before",className:"before-item"},r[n],t().createElement("span",lr({dangerouslySetInnerHTML:{__html:e[n]}},i)))):null}},{key:"render_after_content",value:function(){var e,r,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(n=this.get_column_key(),o=this.get_item())return n in(e=o.after)?(r=o.after_components||{},t().createElement("span",{key:n+"_after",className:"after-item"},r[n],t().createElement("span",lr({dangerouslySetInnerHTML:{__html:e[n]}},i)))):null}},{key:"is_edit_allowed",value:function(){var e,t;return e=this.get_column_key(),t=this.get_item(),!!this.props.allow_edit&&_r.call(t.allow_edit,e)>=0}},{key:"is_disabled",value:function(){var e,t;return!0===(t=this.get_item().disabled)||!1===t?t:null!=t&&(e=this.get_column_key(),_r.call(t,e)>=0)}},{key:"is_required",value:function(){var e,t,r,n;return e=this.get_column_key(),r=this.get_item().required||[],t=_r.call(r,e)>=0,n=this.props.selected,t&&n}},{key:"get_name",value:function(){var e,t;return t=this.get_uid(),e=this.get_column_key(),"".concat(e,".").concat(t)}},{key:"get_uid",value:function(){return this.get_item().uid}},{key:"is_selected",value:function(){var e;return e=this.get_item().uid,_r.call(this.props.selected_uids,e)>=0}},{key:"get_value",value:function(){var e,t,r;return e=this.get_column_key(),r=this.get_item()[e],(t=this.get_interimfields()).hasOwnProperty(e)&&(r=t[e].value||""),null===r&&(r=""),r}},{key:"get_size",value:function(){var e,t,r;return r=5,(t=this.get_item()).hasOwnProperty("size")&&(r=t.size),this.is_interimfield()&&(e=t[this.get_column_key()])&&e.hasOwnProperty("size")&&(r=e.size),r}},{key:"get_formatted_unit",value:function(){var e,t,r;return e=this.get_column_key(),r=(t=this.get_item()).Unit,this.is_interimfield()&&(r=t[e].unit),r?"<span class='unit'>".concat(r,"</span>"):""}},{key:"get_interimfields",value:function(){var e,t;return e=this.get_item().interimfields||[],t={},e.map((function(e,r){return t[e.keyword]=e})),t}},{key:"is_interimfield",value:function(){var e;return e=this.get_column_key(),this.get_interimfields().hasOwnProperty(e)}},{key:"get_choices",value:function(){return this.get_item().choices||{}}},{key:"is_result_column",value:function(){return"Result"===this.get_column_key()}},{key:"get_formatted_value",value:function(){var e,t,r;return e=this.get_column_key(),t=(r=this.get_item()).replace[e]||this.get_value(),this.is_result_column()?(t=r.formatted_result||t)&&(t+=this.get_formatted_unit()):this.is_interimfield()&&t&&(t+=this.get_formatted_unit()),t}},{key:"get_type",value:function(){var e,t,r,n,o,i,s;return t=this.get_column_key(),i=this.get_item(),n=this.is_edit_allowed(),s=this.is_result_column(),n?s&&i.calculation?"calculated":s&&i.result_type?i.result_type:"type"in(e=this.props.column||{})?e.type:"boolean"==typeof this.get_value()?"boolean":t in this.get_choices()?(r="select",s?i.result_type||r:this.is_interimfield()&&(o=i[t=this.get_column_key()])&&o.result_type||r):this.is_interimfield()?(r="interim",(o=i[t=this.get_column_key()])&&o.result_type||r):"numeric":"readonly"}},{key:"create_readonly_field",value:function(){var e,r,n,o,i,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=s.props;return this.get_column_key(),this.get_item(),null==a&&(a={}),n=this.get_name(),i=this.get_value(),r=this.get_formatted_value(),o=this.get_uid(),e="readonly",t().createElement(At,lr({key:n,uid:o,name:n,value:i,formatted_value:r,className:e},a))}},{key:"create_calculated_field",value:function(){var e,r,n,o,i,s,a,c,l,u,f,p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=p.props;return e=this.get_column_key(),o=this.get_item(),null==h&&(h={}),i=this.get_name(),f=this.get_value(),n=this.get_formatted_value(),u=this.get_formatted_unit(),l=this.get_uid(),c=this.props.column.title||e,a=this.is_selected(),r="form-control form-control-sm calculated",(s=this.is_required())&&(r+=" required"),t().createElement(Pt,lr({key:i,uid:l,item:o,name:i,value:f,column_key:e,title:c,formatted_value:n,placeholder:c,selected:a,required:s,className:r,after:u,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field},h))}},{key:"create_hidden_field",value:function(){var e,r,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=i.props;return e=this.get_column_key(),this.get_item(),null==s&&(s={}),r=this.get_name(),o=this.get_value(),this.get_formatted_value(),n=this.get_uid(),this.props.column.title,t().createElement(Ve,lr({key:r+"_hidden",uid:n,name:r,value:o,column_key:e},s))}},{key:"create_numeric_field",value:function(){var e,r,n,o,i,s,a,c,l,u,f,p,h,_,d=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},y=d.props;return e=this.get_column_key(),s=this.get_item(),null==y&&(y={}),a=this.get_name(),_=this.get_value(),i=this.get_formatted_value(),h=this.get_formatted_unit(),p=this.get_uid(),o=a+this.ZPUBLISHER_CONVERTER.numeric,f=this.props.column.title||e,l=this.is_selected(),n=this.is_disabled(),c=this.is_required(),u=this.get_size(),r="form-control form-control-sm",c&&(r+=" required"),t().createElement(wt,lr({key:a,uid:p,item:s,name:o,defaultValue:_,column_key:e,title:f,formatted_value:i,placeholder:f,selected:l,disabled:n,required:c,className:r,after:h,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex,size:u},y))}},{key:"create_string_field",value:function(){var e,r,n,o,i,s,a,c,l,u,f,p,h,_=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=_.props;return e=this.get_column_key(),s=this.get_item(),null==d&&(d={}),a=this.get_name(),h=this.get_value(),i=this.get_formatted_value(),p=this.get_formatted_unit(),f=this.get_uid(),o=a+this.ZPUBLISHER_CONVERTER.string,u=this.props.column.title||e,l=this.is_selected(),n=this.is_disabled(),r="form-control form-control-sm",(c=this.is_required())&&(r+=" required"),t().createElement(Yt,lr({key:a,uid:f,item:s,name:o,defaultValue:h,column_key:e,title:u,formatted_value:i,placeholder:u,selected:l,disabled:n,required:c,className:r,after:p,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},d))}},{key:"create_datetime_field",value:function(){var e,r,n,o,i,s,a,c,l,u,f,p,h,_,d,y,m,b,v,g,w,k=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},O=k.props;if(r=this.get_column_key(),a=this.get_item(),e=this.get_column(),null==O&&(O={}),_=this.get_name(),w=this.get_value(),s=this.get_formatted_value(),g=this.get_formatted_unit(),v=this.get_uid(),i=_+this.ZPUBLISHER_CONVERTER.string,b=this.props.column.title||r,m=this.is_selected(),o=this.is_disabled(),n="form-control form-control-sm",(d=this.is_required())&&(n+=" required"),y="date",f=e.min||null,c=e.max||null,f){var j=f.split(" "),E=ar(j,2);p=E[0],h=E[1]}if(c){var x=c.split(" "),S=ar(x,2);l=S[0],u=S[1]}return t().createElement(ir,lr({key:_,uid:v,item:a,name:i,defaultValue:w,column_key:r,title:b,formatted_value:s,placeholder:b,selected:m,disabled:o,required:d,className:n,results_type:y,after:g,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex,min_date:p,max_date:l,min_time:h,max_time:u},O))}},{key:"create_select_field",value:function(){var e,r,n,o,i,s,a,c,l,u,f,p,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_=h.props;return e=this.get_column_key(),i=this.get_item(),null==_&&(_={}),s=this.get_name(),p=this.get_value(),a=i.choices[e]||[],this.get_formatted_value(),f=this.get_uid(),o=s+this.ZPUBLISHER_CONVERTER.select,u=this.props.column.title||e,l=this.is_selected(),n=this.is_disabled(),r="form-control form-control-sm",(c=this.is_required())&&(r+=" required"),t().createElement(Ut,lr({key:s,uid:f,item:i,name:o,defaultValue:p,column_key:e,title:u,disabled:n,selected:l,required:c,options:a,className:r,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},_))}},{key:"create_multichoice_field",value:function(){var e,r,n,o,i,s,a,c,l,u,f,p,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_=h.props;return e=this.get_column_key(),i=this.get_item(),null==_&&(_={}),s=this.get_name(),(p=this.get_value()).length>0&&(p=JSON.parse(p)),(a=i.choices[e]||[]).forEach((function(e){var t;return t=!1,Array.isArray(p)&&(t=p.indexOf(e.ResultValue)>-1),e.selected=t})),this.get_formatted_value(),f=this.get_uid(),o=s+this.ZPUBLISHER_CONVERTER.multichoice,u=this.props.column.title||e,l=this.is_selected(),n=this.is_disabled(),r="form-control form-control-sm",(c=this.is_required())&&(r+=" required"),t().createElement(Qe,lr({key:s,uid:f,item:i,name:o,column_key:e,title:u,disabled:n,selected:l,required:c,options:a,className:r,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},_))}},{key:"create_multiselect_field",value:function(){var e,r,n,o,i,s,a,c,l,u,f,p,h,_=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},d=_.props;return e=this.get_column_key(),s=this.get_item(),null==d&&(d={}),p=this.get_uid(),a=this.get_name(),h=this.get_value(),c=s.choices[e]||[],this.get_formatted_value(),i=a+this.ZPUBLISHER_CONVERTER.multiselect,f=this.props.column.title||e,u=this.is_selected(),n=this.is_disabled(),l=this.is_required(),o="multiselect_duplicates"===s.result_type,r="form-control form-control-sm",l&&(r+=" required"),t().createElement(ot,lr({key:a,uid:p,item:s,name:i,defaultValue:h,value:h,column_key:e,title:f,disabled:n,selected:u,required:l,options:c,duplicates:o,className:r,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},d))}},{key:"create_multivalue_field",value:function(){var e,r,n,o,i,s,a,c,l,u,f,p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},h=p.props;return e=this.get_column_key(),i=this.get_item(),null==h&&(h={}),u=this.get_uid(),s=this.get_name(),f=this.get_value(),o=s+this.ZPUBLISHER_CONVERTER.multivalue,l=this.props.column.title||e,c=this.is_selected(),n=this.is_disabled(),r="form-control form-control-sm",(a=this.is_required())&&(r+=" required"),t().createElement(pt,lr({key:s,uid:u,item:i,name:o,defaultValue:f,value:f,column_key:e,title:l,disabled:n,selected:c,required:a,className:r,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},h))}},{key:"create_checkbox_field",value:function(){var e,r,n,o,i,s,a,c,l,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=u.props;return e=this.get_column_key(),i=this.get_item(),null==f&&(f={}),s=this.get_name(),l=this.get_value(),i.choices[e],this.get_formatted_value(),c=this.get_uid(),o=s+this.ZPUBLISHER_CONVERTER.boolean,a=this.props.column.title||e,this.is_selected(),n=this.is_disabled(),r="checkbox",this.is_required()&&(r+=" required"),t().createElement(ve,lr({key:s,uid:c,item:i,name:o,value:"on",column_key:e,title:a,defaultChecked:l,disabled:n,className:r,update_editable_field:this.props.update_editable_field,save_editable_field:this.props.save_editable_field,tabIndex:this.props.tabIndex},f))}},{key:"render_content",value:function(){var e,t;return this.get_column_key(),this.get_item()?(this.get_uid(),e=[],e="readonly"===(t=this.get_type())?e.concat(this.create_readonly_field()):"calculated"===t?e.concat(this.create_calculated_field()):"interim"===t?e.concat(this.create_numeric_field()):"select"===t||"choices"===t?e.concat(this.create_select_field()):"multichoice"===t?e.concat(this.create_multichoice_field()):"multiselect"===t||"multiselect_duplicates"===t?e.concat(this.create_multiselect_field()):"multivalue"===t?e.concat(this.create_multivalue_field()):"boolean"===t?e.concat(this.create_checkbox_field()):"numeric"===t?e.concat(this.create_numeric_field()):"string"===t?e.concat(this.create_string_field()):"datetime"===t?e.concat(this.create_datetime_field()):e.concat(this.create_numeric_field())):null}},{key:"render",value:function(){return t().createElement("td",{className:this.props.className,colSpan:this.props.colspan,rowSpan:this.props.rowspan},t().createElement("div",{className:"form-group"},this.render_before_content(),this.render_content(),this.render_after_content()))}}],n&&ur(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function yr(e){return yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yr(e)}function mr(){return mr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mr.apply(this,arguments)}function br(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function vr(e,t){return vr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},vr(e,t)}function gr(e,t){if(t&&("object"===yr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return wr(e)}function wr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function kr(e){return kr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kr(e)}var Or=[].indexOf;const jr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vr(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=kr(o);if(i){var r=kr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return gr(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_blur=t.on_blur.bind(wr(t)),t.on_change=t.on_change.bind(wr(t)),t.state={value:e.value},t}return r=a,(n=[{key:"componentDidUpdate",value:function(e){if(this.props.value!==e.value)return this.setState({value:this.props.value})}},{key:"on_blur",value:function(e){var t,r,n,o;if(n=(t=e.currentTarget).getAttribute("uid"),r=t.getAttribute("column_key")||t.name,o=t.value,this.props.save_editable_field)return this.props.save_editable_field(n,r,o,this.props.item)}},{key:"on_change",value:function(e){var t,r,n,o;if(n=(t=e.currentTarget).getAttribute("uid"),r=t.getAttribute("column_key")||t.name,o=t.value,this.setState({value:o}),this.props.update_editable_field)return this.props.update_editable_field(n,r,o,this.props.item)}},{key:"can_edit",value:function(){var e,t,r;return r=this.props.item,t=this.props.column_key,e=r.allow_edit||[],Or.call(e,t)>=0}},{key:"get_column_title",value:function(){var e;return e=this.props.columns[this.props.column_key].title||"Remarks","function"==typeof _&&(e=_(e)),e}},{key:"get_style",value:function(){var e;return e=this.props.uid,{display:Or.call(this.props.expanded_remarks,e)>=0||this.props.value.length>0?"block":"none"}}},{key:"render_remarks_field",value:function(){var e,r,n;return n=this.props.uid,e=this.props.column_key,r="".concat(e,".").concat(n,":records"),this.can_edit()?t().createElement("textarea",mr({className:"remarksfield form-control",uid:n,column_key:e,style:{width:"100%"},rows:this.props.rows||2,name:r,onBlur:this.props.onBlur||this.on_blur,onChange:this.props.onChange||this.on_change,value:this.state.value,tabIndex:this.props.tabIndex},this.props.attrs)):t().createElement("span",{className:"remarksfield",dangerouslySetInnerHTML:{__html:this.state.value}})}},{key:"render",value:function(){return this.props.uid?t().createElement("div",{style:this.get_style(),className:"remarks text-muted"},this.props.before&&t().createElement("span",{className:"before_field",dangerouslySetInnerHTML:{__html:this.props.before}}),t().createElement("div",{className:"text-info"},t().createElement("i",{className:"fas fa-hand-point-right"})," ",this.get_column_title(),":"),this.render_remarks_field(),this.props.after&&t().createElement("span",{className:"after_field",dangerouslySetInnerHTML:{__html:this.props.after}})):null}}])&&br(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function Er(e){return Er="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Er(e)}function xr(){return xr=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},xr.apply(this,arguments)}function Sr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Pr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Rr(e,t){return Rr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Rr(e,t)}function Nr(e,t){if(t&&("object"===Er(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Tr(e){return Tr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Tr(e)}var Cr=[].indexOf;const Ir=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Rr(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Tr(o);if(i){var r=Tr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Nr(this,e)});function a(){return Sr(this,a),s.apply(this,arguments)}return r=a,n=[{key:"get_item",value:function(){return this.props.item[this.props.column_key]}},{key:"get_column_key",value:function(){return this.props.item.item_key||this.props.item.column_key}},{key:"get_css",value:function(){var e,t,r;return t=this.get_item(),e=["transposed",this.props.className],this.is_result_column()&&e.push("result"),t?(e.push(t.state_class),r=t.uid,Cr.call(this.props.selected_uids,r)>=0&&e.push("info")):e.push("empty"),e.join(" ")}},{key:"get_remarks_columns",value:function(){var e,t,r;for(t in e=[],r=this.props.columns)"remarks"===r[t].type&&e.push(t);return e}},{key:"create_select_checkbox",value:function(){var e,r,n,o,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=i.props;return null==s&&(s={}),o=this.get_uid(),r="".concat(this.props.select_checkbox_name,":list"),e=this.is_disabled(),n=this.is_selected(),t().createElement("div",{key:"select",className:"checkbox"},t().createElement(ve,xr({name:r,value:o,disabled:e,checked:n,onChange:this.props.on_select_checkbox_checked},s)))}},{key:"create_interim_fields",value:function(){var e,t,r,n,o,i,s,a,c,l,u,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},p=f.props;for(null==p&&(p={}),l=this.get_uid(),e=[],r=t=0,s=(o=this.get_item().interimfields||[]).length;t<s;r=++t)i=(n=o[r]).keyword,this.props.columns.hasOwnProperty(i)&&(u=n.unit||"",c=n.title||i,a=n.size||5,p={key:i,column_key:i,name:"".concat(i,".").concat(l),defaultValue:n.value,placeholder:c,formatted_value:n.formatted_value,size:a,before:"<span>".concat(c,"</span>"),after:"<span>".concat(u,"</span>")},this.is_edit_allowed()?(p.className="form-control form-control-sm interim",e=e.concat(this.create_numeric_field({props:p}))):(p.className="readonly interim",e=e.concat(this.create_readonly_field({props:p}))));return e}},{key:"render_content",value:function(){var e,r,n,o,i,s,a,c,l,u,f;if(n=this.get_column_key(),!(s=this.get_item()))return null;if(f=this.get_uid(),u=this.get_type(),o=[],this.is_result_column){for(l=this.props.columns.Result.title,(e={})[n]=[this.create_select_checkbox()],this.get_remarks_columns().length>0&&e[n].push(t().createElement("a",{key:f+"_remarks",href:"#",className:"transposed_remarks",uid:f,onClick:this.props.on_remarks_expand_click},t().createElement("i",{className:"remarksicon fas fa-comment"}))),s.before_components=e,"readonly"===u?o=(o=o.concat(this.create_interim_fields())).concat(this.create_readonly_field()):(o=o.concat(this.create_interim_fields()),o="calculated"===u?o.concat(this.create_calculated_field({props:{before:"<span>".concat(l,"</span>"),after:"<span>".concat(s.Unit||"","</span>")}})):"select"===u||"choices"===u?o.concat(this.create_select_field()):"multichoice"===u?o.concat(this.create_multichoice_field()):"multiselect"===u||"multiselect_duplicates"===u?o.concat(this.create_multiselect_field()):"boolean"===u?o.concat(this.create_checkbox_field()):"numeric"===u?o.concat(this.create_numeric_field()):"string"===u?o.concat(this.create_string_field()):"datetime"===u?o.concat(this.create_datetime_field()):o.concat(this.create_numeric_field())),r=i=0,a=(c=this.get_remarks_columns()).length;i<a;r=++i)s[n=c[r]],o.push(t().createElement("div",{key:r+"_remarks"},t().createElement(jr,xr({},this.props,{uid:f,item:s,column_key:n,value:s[n]}))));return s.replace.Attachments&&(o=o.concat(this.create_readonly_field({props:{key:r+"_attachments",uid:f,item:s,column_key:"Attachments",formatted_value:s.replace.Attachments,attrs:{style:{display:"block"}}}}))),o}}},{key:"render",value:function(){return t().createElement("td",{className:this.get_css(),colSpan:this.props.colspan,rowSpan:this.props.rowspan},t().createElement("div",{className:"form-group"},this.render_before_content(),this.render_content(),this.render_after_content()))}}],n&&Pr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(dr);function Br(e){return Br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Br(e)}function Ar(){return Ar=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ar.apply(this,arguments)}function Dr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function qr(e,t){return qr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},qr(e,t)}function zr(e,t){if(t&&("object"===Br(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Lr(e)}function Lr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Mr(e){return Mr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Mr(e)}var Vr=[].indexOf;const Hr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qr(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Mr(o);if(i){var r=Mr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return zr(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_remarks_expand_click=t.on_remarks_expand_click.bind(Lr(t)),t}return r=a,(n=[{key:"on_remarks_expand_click",value:function(e){var t;if(e.preventDefault(),t=e.currentTarget.getAttribute("uid"),this.props.on_remarks_expand_click)return this.props.on_remarks_expand_click(t)}},{key:"get_column",value:function(e){return this.props.columns[e]}},{key:"get_item",value:function(){return this.props.item}},{key:"get_uid",value:function(){return this.get_item().uid}},{key:"get_tab_index",value:function(e,t){return"disabled"===(t.tabindex||{column_key:"active"})[e]?-1:0}},{key:"get_colspan",value:function(e,t){return(t.colspan||{})[e]}},{key:"get_rowspan",value:function(e,t){return(t.rowspan||{})[e]}},{key:"skip_cell_rendering",value:function(e){var t;return t=this.get_item().skip||[],Vr.call(t,e)>=0}},{key:"show_select",value:function(){var e;return"boolean"==typeof(e=this.get_item()).show_select?e.show_select:this.props.show_select_column}},{key:"is_transposed",value:function(e){return"transposed"===this.get_column(e).type}},{key:"create_select_cell",value:function(){var e,r,n,o,i;return e="".concat(this.props.select_checkbox_name,":list"),r=this.get_item(),i=this.get_uid(),o=this.props.remarks,n=r.node_level||0,t().createElement("td",{key:i,className:"level-".concat(n)},t().createElement(ve,{name:e,value:i,disabled:this.props.disabled,checked:this.props.selected,tabIndex:"-1",onChange:this.props.on_select_checkbox_checked}),o&&t().createElement("a",{uid:i,href:"#",className:"remarks",onClick:this.on_remarks_expand_click},t().createElement("span",{className:"remarksicon fas fa-comment-alt"})))}},{key:"create_regular_cell",value:function(e,r){var n,o,i,s,a,c;return s=this.get_item(),o=this.get_column(e),n=this.get_colspan(e,s),a=this.get_rowspan(e,s),c=this.get_tab_index(e,s),i="contentcell ".concat(e),t().createElement(dr,Ar({},this.props,{key:r,item:s,column_key:e,column_index:r,column:o,colspan:n,rowspan:a,className:i,tabIndex:c}))}},{key:"create_transposed_cell",value:function(e,r){var n,o,i,s,a,c;return s=this.get_item(),o=this.get_column(e),n=this.get_colspan(e,s),a=this.get_rowspan(e,s),c=this.get_tab_index(e,s),i="contentcell ".concat(e),t().createElement(Ir,Ar({},this.props,{key:r,item:s,column_key:e,column_index:r,column:o,colspan:n,rowspan:a,on_remarks_expand_click:this.on_remarks_expand_click,className:i,tabIndex:c}))}},{key:"build_cells",value:function(){var e,t,r,n,o,i;for(e=[],this.show_select()&&e.push(this.create_select_cell()),t=n=0,o=(i=this.props.visible_columns).length;n<o;t=++n)r=i[t],this.skip_cell_rendering(r)||(this.is_transposed(r)?e.push(this.create_transposed_cell(r,t)):e.push(this.create_regular_cell(r,t)));return e}},{key:"render",value:function(){return this.build_cells()}}])&&Dr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function Ur(e){return Ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ur(e)}function Fr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Jr(e,t){return Jr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Jr(e,t)}function Zr(e,t){if(t&&("object"===Ur(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Wr(e){return Wr=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Wr(e)}const $r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jr(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Wr(o);if(i){var r=Wr(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Zr(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,e)}return r=a,(n=[{key:"render",value:function(){return t().createElement("tr",{className:this.props.className,onClick:this.props.onClick,category:this.props.category,uid:this.props.uid},t().createElement(Hr,this.props))}}])&&Fr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function Qr(e){return Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qr(e)}function Kr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yr(e,t){return Yr=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Yr(e,t)}function Xr(e,t){if(t&&("object"===Qr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Gr(e)}function Gr(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function en(e){return en=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},en(e)}const tn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yr(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=en(o);if(i){var r=en(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Xr(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_category_click=t.on_category_click.bind(Gr(t)),t}return r=a,(n=[{key:"on_category_click",value:function(e){var t;if(t=e.currentTarget.getAttribute("category"),this.props.on_category_click)return this.props.on_category_click(t)}},{key:"build_category",value:function(){var e,r;return e="collapsed",r="fas fa-caret-square-up",this.props.expanded&&(e="expanded",r="fas fa-caret-square-down"),t().createElement("td",{key:"toggle",className:e,colSpan:this.props.columns_count},t().createElement("span",{className:r})," ",this.props.category)}},{key:"render",value:function(){return t().createElement("tr",{category:this.props.category,onClick:this.on_category_click,className:this.props.className},this.build_category())}}])&&Kr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function rn(e){return rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},rn(e)}function nn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function on(e,t){return on=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},on(e,t)}function sn(e,t){if(t&&("object"===rn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function an(e){return an=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},an(e)}const cn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&on(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=an(o);if(i){var r=an(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return sn(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,e)}return r=a,(n=[{key:"render",value:function(){return t().createElement("tr",{className:this.props.className},t().createElement("td",{style:{padding:0,borderTop:0}}),t().createElement("td",{style:{padding:0,borderTop:0},colSpan:this.props.colspan-1},t().createElement(jr,this.props)))}}])&&nn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function ln(e){return ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ln(e)}function un(){return un=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},un.apply(this,arguments)}function fn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pn(e,t){return pn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},pn(e,t)}function hn(e,t){if(t&&("object"===ln(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _n(e)}function _n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dn(e){return dn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},dn(e)}var yn=[].indexOf;const mn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pn(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=dn(o);if(i){var r=dn(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return hn(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_row_expand_click=t.on_row_expand_click.bind(_n(t)),t}return r=a,n=[{key:"on_row_expand_click",value:function(e){var t,r,n;if(t=(r=e.currentTarget).children.item(0),e.target===t&&(n=r.getAttribute("uid"),this.props.on_row_expand_click))return this.props.on_row_expand_click(n)}},{key:"is_selected",value:function(e){var t,r;return r=e.uid,t=this.props.selected_uids||[],yn.call(t,r)>=0}},{key:"is_expanded",value:function(e){var t,r;return t=this.props.expanded_rows||[],r=e.uid,yn.call(t,r)>=0}},{key:"get_children",value:function(e){var t;return t=e.uid,(this.props.children||{})[t]||[]}},{key:"is_category_expanded",value:function(e){return yn.call(this.props.expanded_categories,e)>=0}},{key:"is_item_disabled",value:function(e){return e.disabled||!1}},{key:"is_child_item",value:function(e){if(e.parent)return!0}},{key:"get_item_category",value:function(e){return e.category||null}},{key:"get_item_children",value:function(e){return e.children||[]}},{key:"has_item_children",value:function(e){return this.get_item_children(e).length>0}},{key:"get_remarks_columns",value:function(e){var t,r,n;for(r in t=[],n=this.props.columns)if("remarks"===n[r].type){if(void 0===e[r])continue;t.push(r)}return t}},{key:"get_item_uid",value:function(e){return e.uid}},{key:"get_item_css",value:function(e){var t;return t=["contentrow"],e.state_class&&(t=t.concat(e.state_class.split(" "))),this.is_selected(e)&&t.push("table-info"),this.is_child_item(e)?t.push("child"):t.push("parent"),this.has_item_children(e)&&(this.is_expanded(e)?t.push("expanded"):t.push("collapsed")),t.join(" ")}},{key:"render_categorized_rows",value:function(){var e,r,n,o,i,s;if(s=[],this.props.show_categories)for(n=0,o=(i=this.props.categories).length;n<o;n++)e=i[n],r=this.is_category_expanded(e),s.push(t().createElement(tn,un({},this.props,{key:e,category:e,expanded:r,className:"categoryrow"}))),s=s.concat(this.build_rows({props:{category:e}}));else s=this.build_rows();return s}},{key:"build_rows",value:function(){var e,r,n,o,i,s,a,c,l,u,f,p,h,_,d,y,m,b,v,g,w,k,O,j,E=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},x=E.props;for(v=[],null==x&&(x={}),e=x.category||null,_=p=0,y=(f=x.folderitems||this.props.folderitems).length;p<y;_=++p)if(h=f[_],(!e||this.get_item_category(h)===e)&&(!e||this.is_category_expanded(e)||this.is_selected(h))){for(O=this.get_item_uid(h),a=this.get_item_css(h),n=this.get_item_children(h),u=this.is_expanded(h),g=this.is_selected(h),c=this.is_item_disabled(h),l=this.has_item_children(h),b=this.get_remarks_columns(h),k=!1,null===O&&(k=!0,O=_),v.push(t().createElement($r,un({},this.props,{key:O,item:h,uid:O,category:e,expanded:u,remarks:b.length>0,selected:g,disabled:c,className:a,onClick:l&&this.on_row_expand_click||void 0,row_index:_}))),i=d=0,m=b.length;d<m&&(s=b[i],!k);i=++d)this.props.columns[s],w=h.skip||[],o=this.props.columns_count-w.length,j=h[s]||"",v.push(t().createElement(cn,un({},this.props,{key:"remarks_"+_,uid:O,item:h,column_key:s,value:j,expanded:u,selected:g,disabled:c,className:a+" remarksrow",colspan:o,row_index:_})));u&&(n=this.get_children(h)).length>0&&(r=this.build_rows({props:{category:e,folderitems:n}}),v=v.concat(r))}return v}},{key:"render",value:function(){return this.render_categorized_rows()}}],n&&fn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function bn(e){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bn(e)}function vn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function gn(e,t){return gn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},gn(e,t)}function wn(e,t){if(t&&("object"===bn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function kn(e){return kn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},kn(e)}const On=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gn(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=kn(o);if(i){var r=kn(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return wn(this,e)});function a(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),s.call(this,e)}return r=a,(n=[{key:"render",value:function(){return t().createElement("table",{id:this.props.id,className:this.props.className},t().createElement("thead",null,t().createElement(Be,this.props)),t().createElement("tbody",null,t().createElement(mn,this.props)))}}])&&vn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);function jn(e){return jn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jn(e)}function En(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xn(e,t){return xn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xn(e,t)}function Sn(e,t){if(t&&("object"===jn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Pn(e)}function Pn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Rn(e){return Rn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},Rn(e)}const Nn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xn(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Rn(o);if(i){var r=Rn(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Sn(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).on_drag_start=t.on_drag_start.bind(Pn(t)),t.on_drag_end=t.on_drag_end.bind(Pn(t)),t.on_drag_over=t.on_drag_over.bind(Pn(t)),t.on_column_toggle_click=t.on_column_toggle_click.bind(Pn(t)),t.on_reset_click=t.on_reset_click.bind(Pn(t)),t.state={columns_order:t.props.columns_order},t}return r=a,(n=[{key:"componentDidUpdate",value:function(e,t,r){if(this.props.columns_order!==e.columns_order)return this.setState({columns_order:this.props.columns_order})}},{key:"on_reset_click",value:function(e){if(e.preventDefault(),this.props.on_column_toggle_click)return this.props.on_column_toggle_click("reset")}},{key:"on_drag_start",value:function(e){return this.dragged_item=e.currentTarget,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.dragged_item),e.dataTransfer.setDragImage(this.dragged_item,50,0)}},{key:"on_drag_over",value:function(e){var t,r,n,o,i;if((i=e.currentTarget)!==this.dragged_item)return t=this.dragged_item.getAttribute("column"),r=i.getAttribute("column"),o=(n=this.state.columns_order).indexOf(r),(n=n.filter((function(e){return e!==t}))).splice(o,0,t),this.setState({columns_order:n})}},{key:"on_drag_end",value:function(e){if(this.dragged_item=null,this.props.on_columns_order_change)return this.props.on_columns_order_change(this.state.columns_order)}},{key:"on_column_toggle_click",value:function(e){var t;if(e.preventDefault(),t=e.currentTarget.getAttribute("column"),this.props.on_column_toggle_click)return this.props.on_column_toggle_click(t)}},{key:"is_column_visible",value:function(e){return!1!==e.toggle}},{key:"build_column_toggles",value:function(){var e,r,n,o,i,s,a;for(r=[],n=0,i=(s=this.state.columns_order).length;n<i;n++)o=s[n],e=this.props.columns[o],a=this.is_column_visible(e),r.push(t().createElement("li",{key:o,column:o,style:{padding:"0 5px 5px 0"},className:"column",onDragOver:this.on_drag_over},t().createElement("a",{href:"#",column:o,className:"draggable-column",onDragStart:this.on_drag_start,onDragEnd:this.on_drag_end,draggable:!0},t().createElement("span",{column:o,onClick:this.on_column_toggle_click,className:"nav-item btn btn-light btn-sm"},a&&t().createElement("i",{className:"text-primary fas fa-check-square"}),!a&&t().createElement("i",{className:"text-muted fas fa-square"})," ",t().createElement("span",{dangerouslySetInnerHTML:{__html:e.title||o}})))));return r}},{key:"render",value:function(){return t().createElement("div",{id:this.props.id,className:this.props.className},t().createElement("div",{className:"row"},t().createElement("div",{className:"col-sm-12 text-left my-3"},t().createElement("strong",null,this.props.title),t().createElement("div",{className:"help-block"},this.props.description),t().createElement("ul",{className:"list-inline nav nav-pills"},this.build_column_toggles(),t().createElement("li",{key:"reset",style:{padding:"0 5px 5px 0"}},t().createElement("button",{onClick:this.on_reset_click,className:"btn btn-warning btn-sm"},_t("Reset Columns")))))))}}])&&En(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component);var Tn=r(311);function Cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function In(e){return In="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},In(e)}function Bn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function An(e,t){return An=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},An(e,t)}function Dn(e,t){if(t&&("object"===In(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return qn(e)}function qn(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function zn(e){return zn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},zn(e)}var Ln,Mn=[].indexOf;document.addEventListener("DOMContentLoaded",(function(){var e,r,n,i,s,a,c;for(null==window._t&&(window._t=function(e){return e}),c=document.getElementsByClassName("ajax-contents-table"),null==window.listings&&(window.listings={}),s=[],n=0,i=c.length;n<i;n++)r=(a=c[n]).dataset.form_id,e=o().render(t().createElement(Ln,{root_el:a}),a),s.push(window.listings[r]=e);return s})),Ln=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&An(e,t)}(a,e);var r,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=zn(o);if(i){var r=zn(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return Dn(this,e)});function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=s.call(this,e)).dismissMessage=t.dismissMessage.bind(qn(t)),t.doAction=t.doAction.bind(qn(t)),t.filterBySearchterm=t.filterBySearchterm.bind(qn(t)),t.filterByState=t.filterByState.bind(qn(t)),t.on_api_error=t.on_api_error.bind(qn(t)),t.on_column_config_click=t.on_column_config_click.bind(qn(t)),t.on_select_checkbox_checked=t.on_select_checkbox_checked.bind(qn(t)),t.on_reload=t.on_reload.bind(qn(t)),t.saveAjaxQueue=t.saveAjaxQueue.bind(qn(t)),t.saveEditableField=t.saveEditableField.bind(qn(t)),t.setColumnsOrder=t.setColumnsOrder.bind(qn(t)),t.showMore=t.showMore.bind(qn(t)),t.export=t.export.bind(qn(t)),t.sortBy=t.sortBy.bind(qn(t)),t.toggleCategory=t.toggleCategory.bind(qn(t)),t.toggleColumn=t.toggleColumn.bind(qn(t)),t.toggleRemarks=t.toggleRemarks.bind(qn(t)),t.toggleRow=t.toggleRow.bind(qn(t)),t.updateEditableField=t.updateEditableField.bind(qn(t)),t.on_popstate=t.on_popstate.bind(qn(t)),t.root_el=t.props.root_el,t.api_url=t.root_el.dataset.api_url,t.columns=JSON.parse(t.root_el.dataset.columns),t.form_id=t.root_el.dataset.form_id,t.listing_identifier=t.root_el.dataset.listing_identifier,t.pagesize=parseInt(t.root_el.dataset.pagesize),t.review_states=JSON.parse(t.root_el.dataset.review_states),t.show_column_toggles=JSON.parse(t.root_el.dataset.show_column_toggles),t.root_el.addEventListener("reload",t.on_reload),t.api=new T({api_url:t.api_url,on_api_error:t.on_api_error,form_id:t.form_id}),t.filter=t.api.get_url_parameter("filter"),t.pagesize=parseInt(t.api.get_url_parameter("pagesize"))||t.pagesize,t.sort_on=t.api.get_url_parameter("sort_on"),t.sort_order=t.api.get_url_parameter("sort_order"),t.review_state=t.api.get_url_parameter("review_state")||"default",t.state={messages:[],loading:!0,show_column_config:!1,filter:t.filter,pagesize:t.pagesize,sort_on:t.sort_on,sort_order:t.sort_order,review_state:t.review_state,query_string:"",api_url:"",form_id:t.form_id,columns:t.get_default_columns(),review_states:t.review_states,folderitems:[],children:{},categories:[],expanded_categories:[],expanded_rows:[],expanded_remarks:[],total:0,selected_uids:[],transitions:[],catalog_indexes:[],catalog_columns:[],sortable_columns:[],ajax_save_queue:{},content_filter:{},allow_edit:!1,show_select_all_checkbox:!1,show_select_column:!1,show_column_toggles:t.show_column_toggles,select_checkbox_name:"uids",post_action:"workflow_action",show_categories:!1,expand_all_categories:!1,show_more:!1,limit_from:0,show_search:!1,show_ajax_save:!1,show_table_footer:!1,fetch_transitions_on_select:!0,show_export:!0},t}return r=a,n=[{key:"dismissMessage",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null===t?this.setState({messages:[]}):((e=[].concat(this.state.messages)).splice(t,1),this.setState({messages:e})),!0}},{key:"addMessage",value:function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info";return"object"===In(e)&&(e=(o=Object.assign(e)).title,t=o.text,r=o.traceback,i=o.level),(n=[].concat(this.state.messages)).push({title:e,text:t,traceback:r,level:i}),this.setState({messages:n}),!0}},{key:"getRequestOptions",value:function(){return{review_state:this.state.review_state,filter:this.state.filter,sort_on:this.state.sort_on,sort_order:this.state.sort_order,pagesize:this.state.pagesize,limit_from:this.state.limit_from,selected_uids:this.state.selected_uids}}},{key:"componentDidMount",value:function(){return window.addEventListener("popstate",this.on_popstate,!1),this.fetch_folderitems()}},{key:"componentWillUnmount",value:function(){return window.removeEventListener("popstate",this.on_popstate,!1)}},{key:"componentDidUpdate",value:function(e,t,r){}},{key:"toggleCategory",value:function(e){var t,r;return(r=(t=this.state.expanded_categories).indexOf(e))>-1?t.splice(r,1):t.push(e),this.setState({expanded_categories:t}),t.length>0}},{key:"toggleRemarks",value:function(e){var t,r;return!!e&&((r=(t=this.state.expanded_remarks).indexOf(e))>-1?t.splice(r,1):t.push(e),this.setState({expanded_remarks:t}),t.length>0)}},{key:"toggleRow",value:function(e){var t,r,n;return!!e&&((r=(t=this.state.expanded_rows).indexOf(e))>-1?t.splice(r,1):t.push(e),n=this,e in this.state.children?this.setState({expanded_rows:t}):this.fetch_children({parent_uid:e}).then((function(r){var o,i,s,a,c;for(i=n.state.children,a=r.children||[],i[e]=a,s=0,c=a.length;s<c;s++)(o=a[s]).selected&&n.selectUID(o.uid,!0);return n.setState({children:i,expanded_rows:t})})),t.length>0)}},{key:"toggleColumn",value:function(e){var t,r,n,o;if("reset"===e)return this.setState({columns:this.get_default_columns()}),this.set_local_column_config([]),!0;for(e in void 0===(o=(n=this.state.columns)[e].toggle)&&(o=!0),n[e].toggle=!o,r=[],n)t=n[e],r.push({key:e,toggle:t.toggle});return this.set_local_column_config(r),this.setState({columns:n}),o}},{key:"setColumnsOrder",value:function(e){var t,r,n,o,i,s,a,c;for(a={},r=[],(i=Object.keys(this.state.columns)).sort((function(t,r){return e.indexOf(t)-e.indexOf(r)})),n=0,s=i.length;n<s;n++)o=i[n],void 0===(c=(t=this.state.columns[o]).toggle)&&(c=!0),r.push({key:o,toggle:c}),a[o]=t;return this.set_local_column_config(r),this.setState({columns:a}),a}},{key:"get_visible_columns",value:function(){var e,t,r,n,o,i,s;for(n=[],e=this.get_allowed_column_keys(),s=this.get_columns_visibility(),t=0,o=(i=this.get_columns_order()).length;t<o;t++)r=i[t],Mn.call(e,r)<0||!1!==s[r]&&n.push(r);return n}},{key:"get_default_columns",value:function(){return JSON.parse(this.root_el.dataset.columns)}},{key:"get_columns",value:function(){var e,t,r,n,o,i,s,a;for(t={},a=this.get_columns_visibility(),r=0,o=(i=this.get_columns_order()).length;r<o;r++)n=i[r],void 0!==(e=this.state.columns[n])&&(void 0!==(s=a[n])&&(e.toggle=s),t[n]=e);return t}},{key:"get_columns_keys",value:function(){return Object.keys(this.state.columns)}},{key:"get_columns_order",value:function(){var e,t,r;return t=this.get_columns_keys(),r=(r=this.get_local_column_config()).filter((function(e){return-1!==t.indexOf(e.key)})),this.state.show_column_toggles&&r.length>0?r.map((function(e,t){return e.key})):(e=this.get_allowed_column_keys()).concat(t.filter((function(t){return-1===e.indexOf(t)})))}},{key:"get_columns_visibility",value:function(){var e,t,r,n,o,i,s;if(s={},n=this.get_local_column_config(),this.state.show_column_toggles&&n.length>0)for(e=0,r=n.length;e<r;e++){var a=n[e];t=a.key,void 0===(i=a.toggle)&&(i=!0),s[t]=i}else for(t in o=this.state.columns)void 0===(i=o[t].toggle)&&(i=!0),s[t]=i;return s}},{key:"filterByState",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return e=this.get_review_state_by_id(t).listing_config||{},this.set_state(Object.assign({review_state:t,pagesize:this.pagesize,limit_from:0},e)),!0}},{key:"filterBySearchterm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.set_state({filter:e,pagesize:this.pagesize,limit_from:0}),!0}},{key:"sortBy",value:function(e,t){return this.set_state({sort_on:e,sort_order:t,pagesize:this.get_item_count(),limit_from:0}),!0}},{key:"showMore",value:function(e){var t,r;return t=this.state.folderitems,r=this,this.setState({pagesize:parseInt(e),limit_from:this.state.folderitems.length,loading:!0},(function(){return r.api.fetch_folderitems(r.getRequestOptions()).then((function(e){var n;if(r.toggle_loader(!1),e.folderitems.length>0)return n=t.concat(e.folderitems),r.setState({folderitems:n})}))})),!0}},{key:"export",value:function(){var e,t,r,n,o,i,s,a,c,l;return r=this.get_columns_order(),n=this.get_columns_visibility(),r=function(){var t,o,i;for(i=[],t=0,o=r.length;t<o;t++)e=r[t],!0===n[e]&&i.push(e);return i}(),t=this.get_columns(),s=function(){var e,n,o;for(o=[],e=0,n=r.length;e<n;e++)c=r[e],o.push(JSON.stringify(t[c].title||c));return o}(),i=this.state.folderitems,l=function(){var e,t,n;for(n=[],e=0,t=i.length;e<t;e++)a=i[e],n.push(this.to_csv_row(a,r));return n}.call(this),o=(o=s.join(","))+"\n"+l.join("\n"),this.download_csv(o,"download.csv")}},{key:"download_csv",value:function(e,t){var r,n;return r=new Blob(["\ufeff",e],{encoding:"UTF-8",type:"text/csv;charset=UTF-8"}),(n=document.createElement("a")).download=t,n.href=window.URL.createObjectURL(r),n.display="none",document.body.appendChild(n),n.click()}},{key:"to_csv_row",value:function(e,t){var r,n,o,i,s,a,c,l;for(o=[],c=0,l=t.length;c<l;c++)a=t[c],n=e[a]||"","Result"===a?n=e.formatted_result||n:n.constructor===Object&&(n=n.formatted_value||n.value),null!=e.choices&&null!=(s=e.choices[a])&&(i=function(){var e,t,o;for(o=[],e=0,t=s.length;e<t;e++)(r=s[e]).ResultValue===n&&o.push(r.ResultText);return o}(),n=i[0]||n),n=JSON.stringify(n),o.push(n);return o.join(",")}},{key:"loadModal",value:function(e){var t,r,n,o=this;return t=Tn("#modal_".concat(this.form_id)),(e=new URL(e)).searchParams.append("uids",this.state.selected_uids),r=function(e){var r;if(e.preventDefault(),r=e.target,t.modal("hide"),r.action)return fetch(r.action,{method:"POST",body:new FormData(r)}).then((function(e){return e.ok?e.text().then((function(e){return e.startsWith("http")?window.location=e:o.fetch_folderitems()})):Promise.reject(e)})).catch((function(e){}))},n=new Request(e),fetch(n).then((function(e){return e.text().then((function(e){return t.empty(),t.append(e),t.one("submit",r),t.modal("show")}))}))}},{key:"doAction",value:function(e,t){var r,n,o;if(e.startsWith("modal")||e.endsWith("modal_transition"))this.loadModal(t);else{if("clear_selection"!==e)return n=document.getElementById(this.state.form_id),r=e.split("_transition")[0],o=this.create_input_element("hidden",e,"workflow_action_id",r),n.appendChild(o),o=this.create_input_element("hidden","form_id","form_id",this.state.form_id),n.appendChild(o),t&&(n.action=t),n.submit();this.selectUID("all",!1)}}},{key:"create_input_element",value:function(e,t,r,n){var o;return(o=document.createElement("input")).setAttribute("type",e),o.setAttribute("id",t),o.setAttribute("name",r),o.setAttribute("value",n),o}},{key:"selectUID",value:function(e,t){var r,n,o,i,s,a,c,l,u=this;if(l=[].concat(this.state.selected_uids),!0===t)if("all"===e)for(i=0,s=(n=this.state.folderitems.filter((function(e){return!e.disabled})).map((function(e){return e.uid}))).length;i<s;i++)e=n[i],Mn.call(l,e)<0&&l.push(e);else Mn.call(l,e)<0&&l.push(e);else"all"===e?(o=this.group_by_uid(this.state.folderitems),l=l.filter((function(e){return o[e].readonly}))):(a=l.indexOf(e),l.splice(a,1));if(r=l.filter((function(e){return-1===u.state.selected_uids.indexOf(e)})).length>0,c=this.state.selected_uids.filter((function(e){return-1===l.indexOf(e)})).length>0,r||c)return new Promise((function(e,t){return u.setState({selected_uids:l},e)}))}},{key:"saveAjaxQueue",value:function(){return Object.keys(this.state.ajax_save_queue).length>0&&this.ajax_save()}},{key:"saveEditableField",value:function(e,t,r,n){var o,i,s,a;return!(Mn.call(n.allow_edit,t)<0||((i=this.state.columns[t]||{}).ajax&&(a=this,null==(o=this.state.ajax_save_queue)[e]&&(o[e]={}),o[e][t]=r,this.setState({show_ajax_save:!0,ajax_save_queue:o},(function(){if(i.autosave)return a.ajax_save()}))),(s=i.on_change)&&this.ajax_on_change(s,{uid:e,name:t,value:r,item:n}),0))}},{key:"updateEditableField",value:function(e,t,r,n){var o;return this.saveEditableField(e,t,r,n),o=this,this.is_uid_selected(e)||(o=this,this.selectUID(e,!0).then((function(){if(o.state.fetch_transitions_on_select)return o.fetch_transitions()}))),!0}},{key:"is_uid_selected",value:function(e){return Mn.call(this.state.selected_uids,e)>=0}},{key:"get_review_state_by_id",value:function(e){var t,r,n,o,i;for(t=null,r=0,n=(o=this.state.review_states).length;r<n;r++)if((i=o[r]).id===e){t=i;break}return t||{id:"default",columns:this.get_columns_keys()}}},{key:"get_allowed_column_keys",value:function(){var e,t,r;return r=this.state.review_state,(t=this.get_review_state_by_id(r).columns)||Object.keys(this.state.columns),e=this.state.columns,t.filter((function(t){return void 0!==e[t]}))}},{key:"get_local_storage_key",value:function(e,t){var r;return r=this.listing_identifier,void 0===this.listing_identifier&&(r=location.pathname),void 0!==e&&(r=e+r),void 0!==t&&(r+=t),r}},{key:"set_local_column_config",value:function(e){var t;return t=this.get_local_storage_key("columns-"),window.localStorage.setItem(t,JSON.stringify(e)),!0}},{key:"get_local_column_config",value:function(){var e,t;if(t=this.get_local_storage_key("columns-"),!(e=window.localStorage.getItem(t)))return[];try{return JSON.parse(e)}catch(e){return[]}}},{key:"get_columns_count",value:function(){var e;return e=this.get_visible_columns().length,this.state.show_select_column&&(e+=1),e}},{key:"get_expanded_categories",value:function(){return this.state.expand_all_categories||this.state.filter?[].concat(this.state.categories):[]}},{key:"group_by_uid",value:function(e){var t;return null==e&&(e=this.state.folderitems),t={},e.map((function(e,r){var n;return n=e.uid||e.column_key||r,t[n]=e})),t}},{key:"get_item_count",value:function(){return this.state.folderitems.length}},{key:"toggle_loader",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.setState({loading:e}),e}},{key:"set_state",value:function(e){var t,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t=this,this.setState(e,(function(){if(r)return t.fetch_folderitems()})),!0}},{key:"fetch_transitions",value:function(){var e,t,r;if(0!==this.state.selected_uids.length)return this.toggle_loader(!0),t=this.getRequestOptions(),this.update_location_hash(t),r=this.api.fetch_transitions(t),e=this,r.then((function(t){return e.setState(t,(function(){return e.toggle_loader(!1)}))})),r;this.setState({transitions:[]})}},{key:"fetch_folderitems",value:function(){var e,t,r;return this.toggle_loader(!0),t=this.getRequestOptions(),this.update_location_hash(t),r=this.api.fetch_folderitems(t),e=this,r.then((function(t){var r,n,o,i,s,a,c,l,u;for(n=e.group_by_uid(e.state.folderitems),c=e.group_by_uid(t.folderitems),a=t.categories||[],i=0,s=(l=e.state.selected_uids).length;i<s;i++)if(!((u=l[i])in c)){if(!(o=n[u]))continue;c[u]=n[u],(r=o.category)&&Mn.call(a,r)<0&&(a.push(r),a.sort())}return t.categories=a,t.folderitems=Object.values(c),e.setState(t,(function(){return e.setState({expanded_categories:e.get_expanded_categories()},(function(){})),e.toggle_loader(!1)}))})),r}},{key:"fetch_children",value:function(){var e,t,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=n.parent_uid,i=n.child_uids;return this.toggle_loader(!0),i||(i=[],o in(e=this.group_by_uid())&&(i=e[o].children||[])),r=this.api.fetch_children({parent_uid:o,child_uids:i}),t=this,r.then((function(e){return t.toggle_loader(!1)})),r}},{key:"render_toolbar_top",value:function(){return!!this.state.show_more||!!this.state.show_search||this.state.review_states.length>1}},{key:"ajax_save",value:function(){var e,t;return this.toggle_loader(!0),t=this.api.set_fields({save_queue:this.state.ajax_save_queue}),e=this,t.then((function(t){var r;return(t.uids||[]).map((function(t,r){return e.selectUID(t,!0)})),r=t.folderitems||[],e.update_existing_folderitems_with(r),e.state.fetch_transitions_on_select&&e.fetch_transitions(),e.setState({show_ajax_save:!1,ajax_save_queue:{}}),e.toggle_loader(!1)})),t}},{key:"ajax_on_change",value:function(e,t){var r,n;return this.toggle_loader(!0),n=this.api.on_change({handler:e,data:t}),r=this,n.then((function(e){var t;return t=e.folderitems||[],r.update_existing_folderitems_with(t),r.toggle_loader(!1)})),n}},{key:"update_existing_folderitems_with",value:function(e){var t,r,n,o,i,s,a,c;for(a in o=[],c=this.group_by_uid(e),t=this.group_by_uid(this.state.folderitems))if(r=t[a],s=Object.assign({},r),a in c){for(n in i=Object.assign({},c[a]),s)s[n],"rowspan"!==n&&"colspan"!==n&&"skip"!==n||(i[n]=s[n]),i.hasOwnProperty(n)||(i[n]=s[n]);o.push(i)}else o.push(s);return this.setState({folderitems:o})}},{key:"update_location_hash",value:function(e){var t,r,n,o,i,s;for(n in null==e&&(e={}),i=[],t=["filter","pagesize","review_state","sort_on","sort_order"],e)s=e[n],-1!==t.indexOf(n)&&(o=this.api.to_form_name(n),i=i.concat("".concat(o,"=").concat(s)));return r=i.join("&"),location.hash="#?".concat(r)}},{key:"on_column_config_click",value:function(e){var t;if(e.preventDefault(),this.state.show_column_toggles)return t=!this.state.show_column_config,this.setState({show_column_config:t})}},{key:"on_select_checkbox_checked",value:function(e){var t,r,n,o;return n=this,o=(r=e.currentTarget).value,t=r.checked,this.selectUID(o,t).then((function(){if(n.state.fetch_transitions_on_select)return n.fetch_transitions()}))}},{key:"on_api_error",value:function(e){var t=this;return this.toggle_loader(!1),e.text().then((function(r){var n,o;return o=_t("Oops, an error occured! 🙈"),n=_t("The server responded with the status ".concat(e.status,": ").concat(e.statusText)),t.addMessage(o,n,null,"danger")})),e}},{key:"on_reload",value:function(e){return this.fetch_folderitems()}},{key:"on_popstate",value:function(e){var t,r,n,o,i,s,a,c;for(t in o=this.api.parse_hash(location.hash)){var l=(a=o[t].split("="),c=2,function(e){if(Array.isArray(e))return e}(a)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i=[],s=!0,a=!1;try{for(r=r.call(e);!(s=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==r.return||r.return()}finally{if(a)throw o}}return i}}(a,c)||function(e,t){if(e){if("string"==typeof e)return Cn(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cn(e,t):void 0}}(a,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());r=l[0],s=l[1],r.startsWith(this.form_id)&&(n=r.replace("".concat(this.form_id,"_"),""))in this.state&&("pagesize"===n&&(s=parseInt(s)),s!==this.state[n]&&(this.state[n]=s,i=!0))}if(i)return this.fetch_folderitems()}},{key:"render",value:function(){var e,r,n,o,i,s;return e=this.get_columns(),n=this.get_columns_order(),r=this.get_columns_count(),s=this.get_visible_columns(),o=this.get_item_count(),i=this.render_toolbar_top(),t().createElement("div",{className:"listing-container"},t().createElement(Y,{className:"modal fade",id:"modal_".concat(this.form_id)}),t().createElement(J,{on_dismiss_message:this.dismissMessage,id:"messages",className:"messages",messages:this.state.messages}),this.state.loading&&t().createElement("div",{id:"table-overlay"}),!i&&this.state.loading&&t().createElement(z,{loading:this.state.loading}),i&&t().createElement("div",{className:"row top-toolbar"},t().createElement("div",{className:"col-sm-8"},t().createElement(R,{className:"filterbar nav nav-pills",on_filter_button_clicked:this.filterByState,review_state:this.state.review_state,review_states:this.state.review_states})),t().createElement("div",{className:"col-sm-1 text-right"},t().createElement(z,{loading:this.state.loading})),t().createElement("div",{className:"col-sm-3 text-right"},t().createElement(fe,{show_search:this.state.show_search,on_search:this.filterBySearchterm,filter:this.state.filter,placeholder:_t("Search")}))),t().createElement("div",{className:"row"},t().createElement("div",{className:"col-sm-12 table-responsive"},this.state.show_column_toggles&&t().createElement("a",{href:"#",onClick:this.on_column_config_click,className:"pull-right"},t().createElement("i",{className:"fas fa-ellipsis-h"})),this.state.show_column_config&&t().createElement(Nn,{title:_t("Configure Table Columns"),description:_t("Click to toggle the visibility or drag&drop to change the order"),columns:e,columns_order:n,on_column_toggle_click:this.toggleColumn,on_columns_order_change:this.setColumnsOrder}),t().createElement(On,{className:"contentstable table table-hover small",allow_edit:this.state.allow_edit,on_header_column_click:this.sortBy,on_select_checkbox_checked:this.on_select_checkbox_checked,on_context_menu:this.on_column_config_click,sort_on:this.state.sort_on,sort_order:this.state.sort_order,catalog_indexes:this.state.catalog_indexes,catalog_columns:this.state.catalog_columns,sortable_columns:this.state.sortable_columns,columns:e,columns_count:r,review_state:this.state.review_state,visible_columns:s,review_states:this.state.review_states,folderitems:this.state.folderitems,children:this.state.children,selected_uids:this.state.selected_uids,select_checkbox_name:this.state.select_checkbox_name,show_select_column:this.state.show_select_column,show_select_all_checkbox:this.state.show_select_all_checkbox,categories:this.state.categories,expanded_categories:this.state.expanded_categories,expanded_rows:this.state.expanded_rows,expanded_remarks:this.state.expanded_remarks,show_categories:this.state.show_categories,on_category_click:this.toggleCategory,on_row_expand_click:this.toggleRow,on_remarks_expand_click:this.toggleRemarks,filter:this.state.filter,update_editable_field:this.updateEditableField,save_editable_field:this.saveEditableField}))),this.state.show_table_footer&&t().createElement("div",{className:"row"},t().createElement("div",{className:"col-sm-8"},t().createElement(k,{className:"buttonbar nav nav-pills",show_ajax_save:this.state.show_ajax_save,ajax_save_button_title:_t("Save"),on_transition_button_click:this.doAction,on_ajax_save_button_click:this.saveAjaxQueue,selected_uids:this.state.selected_uids,show_select_column:this.state.show_select_column,transitions:this.state.transitions,review_state:this.get_review_state_by_id(this.state.review_state)})),t().createElement("div",{className:"col-sm-1 text-right"},t().createElement(z,{loading:this.state.loading})),t().createElement("div",{className:"col-sm-3 text-right"},t().createElement(oe,{id:"pagination",className:"pagination-controls",total:this.state.total,show_more_button_title:_t("Show more"),onShowMore:this.showMore,show_more:this.state.show_more,count:o,pagesize:this.state.pagesize,export_button_title:_t("Export"),show_export:this.state.show_export,onExport:this.export}))))}}],n&&Bn(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(t().Component)})()})();